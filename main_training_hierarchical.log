2025-05-08 16:35:58,530 - TrainHierarchicalCtcMultiScaleScript - INFO - Using device: cuda
2025-05-08 16:35:58,531 - TrainHierarchicalCtcMultiScaleScript - INFO - Using fusion layers: [-1, -4]
2025-05-08 16:35:58,531 - TrainHierarchicalCtcMultiScaleScript - INFO - Building COMBINED char vocab from generator...
2025-05-08 16:35:58,531 - utils.ctc_utils - INFO - Built CTC vocab with 229 tokens (Blank: True, UNK: True)
2025-05-08 16:35:58,532 - TrainHierarchicalCtcMultiScaleScript - INFO - Saved generated COMBINED vocab to outputs/hierarchical_enhanced_diacritics/combined_char_vocab.json
2025-05-08 16:35:58,532 - TrainHierarchicalCtcMultiScaleScript - INFO - Loading dataset: vklinhhh/vnhwt_opt_1
2025-05-08 16:36:02,895 - TrainHierarchicalCtcMultiScaleScript - WARNING - Splitting train set for validation.
2025-05-08 16:36:03,156 - TrainHierarchicalCtcMultiScaleScript - INFO - Train size: 292050, Val size: 32451
2025-05-08 16:36:03,157 - TrainHierarchicalCtcMultiScaleScript - INFO - Initializing HierarchicalCtcMultiScaleOcrModel configuration...
2025-05-08 16:36:03,157 - TrainHierarchicalCtcMultiScaleScript - INFO - Instantiating/Loading model from: microsoft/trocr-base-handwritten
2025-05-08 16:36:03,157 - model.hierarchical_ctc_model - INFO - Loading HierarchicalCtcMultiScaleOcrModel from: microsoft/trocr-base-handwritten
2025-05-08 16:36:03,157 - model.hierarchical_ctc_model - WARNING - Config file not found at microsoft/trocr-base-handwritten/config.json. Initializing new config.
2025-05-08 16:36:03,158 - model.hierarchical_ctc_model - INFO - Initializing HierarchicalCtcOcrModel...
2025-05-08 16:36:07,336 - model.hierarchical_ctc_model - INFO - Processor and Vision Encoder loaded.
2025-05-08 16:36:07,337 - model.hierarchical_ctc_model - INFO - Using hidden size from config object: 768
2025-05-08 16:36:07,337 - model.hierarchical_ctc_model - INFO - Using 'add' feature fusion
2025-05-08 16:36:07,337 - model.hierarchical_ctc_model - INFO - Adding 2 RNN layers (Input Size: 768)...
2025-05-08 16:36:07,389 - model.hierarchical_ctc_model - INFO - Added 1 shared feature layer(s) (Final Output: 512)
2025-05-08 16:36:07,389 - model.hierarchical_ctc_model - INFO - Added Base Classifier Head (Output: 97)
2025-05-08 16:36:07,391 - model.hierarchical_ctc_model - INFO - Using 'concat_proj' conditioning for diacritic head.
2025-05-08 16:36:07,397 - model.hierarchical_ctc_model - INFO - Initialized Visual Diacritic Attention module
2025-05-08 16:36:07,398 - model.diacritic_attention - INFO - Found 12 vowels, 42 consonants, 0 special vowels in base vocabulary
2025-05-08 16:36:07,399 - model.diacritic_attention - INFO - Found 5 tone marks, 3 modifiers, 15 combined diacritics in diacritic vocabulary
2025-05-08 16:36:07,401 - model.diacritic_attention - INFO - Initialized character-diacritic compatibility matrix with linguistic priors
2025-05-08 16:36:07,401 - model.hierarchical_ctc_model - INFO - Initialized Character-Diacritic Compatibility module
2025-05-08 16:36:07,414 - model.hierarchical_ctc_model - INFO - Initialized Few-Shot Diacritic Adapter with 10 prototypes
2025-05-08 16:36:07,414 - model.hierarchical_ctc_model - INFO - Added Diacritic Classifier Head (Input: 512, Output: 27)
2025-05-08 16:36:07,415 - model.hierarchical_ctc_model - INFO - Added Final Combined Classifier Head (Input: 512, Output: 229)
2025-05-08 16:36:07,460 - model.hierarchical_ctc_model - INFO - Loading base weights only.
2025-05-08 16:36:07,461 - TrainHierarchicalCtcMultiScaleScript - INFO - Model and Processor initialized.
2025-05-08 16:36:07,461 - TrainHierarchicalCtcMultiScaleScript - INFO - Visual Diacritic Attention mechanism ENABLED
2025-05-08 16:36:07,461 - TrainHierarchicalCtcMultiScaleScript - INFO - Character-Diacritic Compatibility matrix ENABLED
2025-05-08 16:36:07,461 - TrainHierarchicalCtcMultiScaleScript - INFO - Few-Shot Diacritic Adapter ENABLED with 10 prototypes per class
2025-05-08 16:36:07,461 - TrainHierarchicalCtcMultiScaleScript - INFO - Creating CTC dataset wrappers (using combined vocab)...
2025-05-08 16:36:07,461 - TrainHierarchicalCtcMultiScaleScript - INFO - CTC Dataset wrappers created.
2025-05-08 16:36:07,771 - TrainHierarchicalCtcMultiScaleScript - INFO - Model on device: cuda
2025-05-08 16:36:07,771 - utils.optimizers - INFO - Using single learning rate: 5e-05
2025-05-08 16:36:07,772 - TrainHierarchicalCtcMultiScaleScript - INFO - Scheduler Setup: Steps=1825400, Warmup=18254
2025-05-08 16:36:07,772 - TrainHierarchicalCtcMultiScaleScript - INFO - Using standard CosineWarmupScheduler
2025-05-08 16:36:07,772 - utils.schedulers - INFO - CosineWarmupScheduler initialized: warmup=18254, max_steps=1825400, eta_min=0
2025-05-08 16:36:07,772 - TrainHierarchicalCtcMultiScaleScript - INFO - Optimizer/Scheduler created.
2025-05-08 16:36:07,772 - TrainHierarchicalCtcMultiScaleScript - INFO - No checkpoint found.
2025-05-08 16:36:07,772 - TrainHierarchicalCtcMultiScaleScript - INFO - Starting fresh or from base weights.
2025-05-08 16:36:07,773 - TrainHierarchicalCtcMultiScaleScript - INFO - ============ Starting Hierarchical CTC Training Phase ============
2025-05-08 16:36:07,773 - CtcTrainer - INFO - Trainer using device: cuda
2025-05-08 16:36:07,773 - CtcTrainer - INFO - Train DataLoader: 18254 batches, Val DataLoader: 2029 batches
2025-05-08 16:36:07,773 - CtcTrainer - INFO - Trainer starting with default GradScaler state.
2025-05-08 16:36:07,774 - CtcTrainer - INFO - Using combined_char_vocab for validation decoder.
2025-05-08 16:36:07,774 - CtcTrainer - INFO - Validation CTCDecoder initialized (Blank Index: 0).
2025-05-08 16:36:07,774 - CtcTrainer - INFO - --- Starting Training Loop from Epoch 1 ---
2025-05-08 16:36:07,774 - CtcTrainer - INFO - Starting with default GradScaler state.
2025-05-08 16:36:07,774 - CtcTrainer - INFO - Starting Epoch 1/100
2025-05-08 16:59:16,956 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 17:16:34,305 - CtcTrainer - INFO - Running end-of-epoch 1 validation...
2025-05-08 17:16:37,169 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 17:16:37,170 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 17:16:37,170 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 17:16:37,170 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:16:37,170 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 17:16:37,170 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 17:16:37,170 - training.ctc_validation - INFO -   Prediction  : 'ruậật'
2025-05-08 17:16:37,170 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:16:37,170 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 17:16:37,171 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 17:16:37,171 - training.ctc_validation - INFO -   Prediction  : 'ban gai lel l bonn n hitte o, i liit dee ada ng'
2025-05-08 17:16:37,171 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:16:37,171 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 17:16:37,171 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 17:16:37,171 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 17:16:37,171 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:16:37,171 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 17:16:37,171 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 17:16:37,171 - training.ctc_validation - INFO -   Prediction  : 'ddnk'
2025-05-08 17:16:37,171 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:19:31,547 - training.ctc_validation - INFO - Validation Results: Loss=22.1247, CER=0.4403, WER=0.8292
2025-05-08 17:19:31,547 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 17:19:31,549 - CtcTrainer - INFO - --- Epoch 1/100 Summary ---
2025-05-08 17:19:31,549 - CtcTrainer - INFO - Avg Train Loss: 20.1468
2025-05-08 17:19:31,549 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 22.12469435012938, 'val_cer': 0.4403177550809863, 'val_wer': 0.8291626768805193}
2025-05-08 17:19:31,549 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: inf
2025-05-08 17:19:31,549 - CtcTrainer - INFO - ---------------------
2025-05-08 17:19:31,551 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 17:19:32,555 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 17:19:32,555 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 17:19:33,546 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 17:19:33,547 - CtcTrainer - INFO - New best metric (val_cer) at epoch 1: 0.4403
2025-05-08 17:19:33,549 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 17:19:33,550 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 17:19:33,551 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 17:19:34,063 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 17:19:34,063 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 17:19:34,481 - CtcTrainer - INFO - Starting Epoch 2/100
2025-05-08 17:23:48,008 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 17:59:52,990 - CtcTrainer - INFO - Running end-of-epoch 2 validation...
2025-05-08 17:59:54,754 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 17:59:54,755 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 17:59:54,755 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 17:59:54,755 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:59:54,755 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 17:59:54,755 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 17:59:54,755 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 17:59:54,755 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:59:54,755 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 17:59:54,756 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 17:59:54,756 - training.ctc_validation - INFO -   Prediction  : 'ha Gint Ke Bon Hiteer e Biet dea ender evg'
2025-05-08 17:59:54,756 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:59:54,756 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 17:59:54,756 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 17:59:54,756 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 17:59:54,756 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 17:59:54,756 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 17:59:54,756 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 17:59:54,756 - training.ctc_validation - INFO -   Prediction  : 'địne'
2025-05-08 17:59:54,756 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 18:02:48,925 - training.ctc_validation - INFO - Validation Results: Loss=15.7946, CER=0.3291, WER=0.6468
2025-05-08 18:02:48,926 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 18:02:48,928 - CtcTrainer - INFO - --- Epoch 2/100 Summary ---
2025-05-08 18:02:48,928 - CtcTrainer - INFO - Avg Train Loss: 0.8604
2025-05-08 18:02:48,928 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 15.79461868171284, 'val_cer': 0.32909867825978467, 'val_wer': 0.6468028513671668}
2025-05-08 18:02:48,928 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.4403
2025-05-08 18:02:48,928 - CtcTrainer - INFO - ---------------------
2025-05-08 18:02:48,931 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 18:02:50,780 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 18:02:50,781 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 18:02:52,245 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 18:02:52,246 - CtcTrainer - INFO - New best metric (val_cer) at epoch 2: 0.3291
2025-05-08 18:02:52,249 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 18:02:52,250 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 18:02:52,252 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 18:02:53,052 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 18:02:53,053 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 18:02:53,394 - CtcTrainer - INFO - Starting Epoch 3/100
2025-05-08 18:30:36,547 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 18:43:09,850 - CtcTrainer - INFO - Running end-of-epoch 3 validation...
2025-05-08 18:43:11,672 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 18:43:11,673 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 18:43:11,673 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 18:43:11,673 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 18:43:11,673 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 18:43:11,673 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 18:43:11,673 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 18:43:11,673 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 18:43:11,673 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 18:43:11,673 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 18:43:11,674 - training.ctc_validation - INFO -   Prediction  : 'hoer gudd ike Bor i Biter og ikit den ener vvg'
2025-05-08 18:43:11,674 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 18:43:11,674 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 18:43:11,674 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 18:43:11,674 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 18:43:11,674 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 18:43:11,674 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 18:43:11,674 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 18:43:11,674 - training.ctc_validation - INFO -   Prediction  : 'đine'
2025-05-08 18:43:11,674 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 18:46:05,620 - training.ctc_validation - INFO - Validation Results: Loss=13.1860, CER=0.2778, WER=0.5674
2025-05-08 18:46:05,620 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 18:46:05,623 - CtcTrainer - INFO - --- Epoch 3/100 Summary ---
2025-05-08 18:46:05,623 - CtcTrainer - INFO - Avg Train Loss: 0.6098
2025-05-08 18:46:05,623 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 13.18600492229675, 'val_cer': 0.27779337282479083, 'val_wer': 0.5674327056069794}
2025-05-08 18:46:05,623 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.3291
2025-05-08 18:46:05,623 - CtcTrainer - INFO - ---------------------
2025-05-08 18:46:05,625 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 18:46:07,571 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 18:46:07,571 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 18:46:09,303 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 18:46:09,304 - CtcTrainer - INFO - New best metric (val_cer) at epoch 3: 0.2778
2025-05-08 18:46:09,308 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 18:46:09,308 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 18:46:09,310 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 18:46:09,978 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 18:46:09,978 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 18:46:10,290 - CtcTrainer - INFO - Starting Epoch 4/100
2025-05-08 19:14:18,595 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 19:26:32,633 - CtcTrainer - INFO - Running end-of-epoch 4 validation...
2025-05-08 19:26:34,552 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Prediction  : 'huver sud ikkee Bori Hinter og i Hist der er der evig'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-08 19:26:34,553 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 19:29:28,629 - training.ctc_validation - INFO - Validation Results: Loss=11.1181, CER=0.2394, WER=0.5115
2025-05-08 19:29:28,629 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 19:29:28,632 - CtcTrainer - INFO - --- Epoch 4/100 Summary ---
2025-05-08 19:29:28,632 - CtcTrainer - INFO - Avg Train Loss: 0.5080
2025-05-08 19:29:28,632 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 11.118066218060148, 'val_cer': 0.2394103632686259, 'val_wer': 0.5114586658155122}
2025-05-08 19:29:28,632 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2778
2025-05-08 19:29:28,632 - CtcTrainer - INFO - ---------------------
2025-05-08 19:29:28,635 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 19:29:30,281 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 19:29:30,282 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 19:29:32,155 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 19:29:32,155 - CtcTrainer - INFO - New best metric (val_cer) at epoch 4: 0.2394
2025-05-08 19:29:32,158 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 19:29:32,159 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 19:29:32,161 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 19:29:32,955 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 19:29:32,956 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 19:29:33,309 - CtcTrainer - INFO - Starting Epoch 5/100
2025-05-08 20:05:09,695 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 20:09:58,605 - CtcTrainer - INFO - Running end-of-epoch 5 validation...
2025-05-08 20:10:00,420 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 20:10:00,420 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 20:10:00,420 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 20:10:00,420 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:10:00,420 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 20:10:00,420 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 20:10:00,420 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 20:10:00,420 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:10:00,421 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 20:10:00,421 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 20:10:00,421 - training.ctc_validation - INFO -   Prediction  : 'heor gud ile bori kiter ogi kiet dhe ander erig'
2025-05-08 20:10:00,421 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:10:00,421 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 20:10:00,421 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 20:10:00,421 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 20:10:00,421 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:10:00,421 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 20:10:00,421 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 20:10:00,421 - training.ctc_validation - INFO -   Prediction  : 'địng'
2025-05-08 20:10:00,421 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:12:54,055 - training.ctc_validation - INFO - Validation Results: Loss=10.3871, CER=0.2252, WER=0.4788
2025-05-08 20:12:54,056 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 20:12:54,058 - CtcTrainer - INFO - --- Epoch 5/100 Summary ---
2025-05-08 20:12:54,058 - CtcTrainer - INFO - Avg Train Loss: 0.4199
2025-05-08 20:12:54,058 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 10.387130695514761, 'val_cer': 0.22520927353472536, 'val_wer': 0.47880625598467924}
2025-05-08 20:12:54,058 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2394
2025-05-08 20:12:54,058 - CtcTrainer - INFO - ---------------------
2025-05-08 20:12:54,061 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 20:12:55,748 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 20:12:55,748 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 20:12:57,612 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 20:12:57,612 - CtcTrainer - INFO - New best metric (val_cer) at epoch 5: 0.2252
2025-05-08 20:12:57,615 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 20:12:57,616 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 20:12:57,618 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 20:12:58,396 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 20:12:58,397 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 20:12:58,983 - CtcTrainer - INFO - Starting Epoch 6/100
2025-05-08 20:13:54,147 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 20:53:19,459 - CtcTrainer - INFO - Running end-of-epoch 6 validation...
2025-05-08 20:53:21,317 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Prediction  : 'havr Gud ikke bev i Hirter g  Hudt, der er den evvig'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-08 20:53:21,318 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 20:56:15,348 - training.ctc_validation - INFO - Validation Results: Loss=9.3171, CER=0.2024, WER=0.4541
2025-05-08 20:56:15,349 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 20:56:15,351 - CtcTrainer - INFO - --- Epoch 6/100 Summary ---
2025-05-08 20:56:15,351 - CtcTrainer - INFO - Avg Train Loss: 0.3669
2025-05-08 20:56:15,351 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 9.317065559577172, 'val_cer': 0.202406915563617, 'val_wer': 0.45406958187041174}
2025-05-08 20:56:15,351 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2252
2025-05-08 20:56:15,351 - CtcTrainer - INFO - ---------------------
2025-05-08 20:56:15,353 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 20:56:16,887 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 20:56:16,887 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 20:56:18,687 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 20:56:18,687 - CtcTrainer - INFO - New best metric (val_cer) at epoch 6: 0.2024
2025-05-08 20:56:18,691 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 20:56:18,691 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 20:56:18,693 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 20:56:19,472 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 20:56:19,472 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 20:56:19,833 - CtcTrainer - INFO - Starting Epoch 7/100
2025-05-08 21:01:38,883 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 21:36:46,967 - CtcTrainer - INFO - Running end-of-epoch 7 validation...
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Prediction  : 'hvor gud ikke bor i Sjeter o i kyet, der er der erig'
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 21:36:48,799 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 21:36:48,799 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 21:36:48,800 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 21:36:48,800 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 21:36:48,800 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 21:36:48,800 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 21:36:48,800 - training.ctc_validation - INFO -   Prediction  : 'địng'
2025-05-08 21:36:48,800 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 21:39:43,335 - training.ctc_validation - INFO - Validation Results: Loss=8.2679, CER=0.1817, WER=0.4245
2025-05-08 21:39:43,335 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 21:39:43,338 - CtcTrainer - INFO - --- Epoch 7/100 Summary ---
2025-05-08 21:39:43,338 - CtcTrainer - INFO - Avg Train Loss: 0.3257
2025-05-08 21:39:43,338 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 8.267882677649963, 'val_cer': 0.181735080938294, 'val_wer': 0.424502606660283}
2025-05-08 21:39:43,338 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.2024
2025-05-08 21:39:43,338 - CtcTrainer - INFO - ---------------------
2025-05-08 21:39:43,340 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 21:39:44,839 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 21:39:44,839 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 21:39:46,594 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 21:39:46,595 - CtcTrainer - INFO - New best metric (val_cer) at epoch 7: 0.1817
2025-05-08 21:39:46,599 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 21:39:46,600 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 21:39:46,601 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 21:39:47,431 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 21:39:47,432 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 21:39:47,778 - CtcTrainer - INFO - Starting Epoch 8/100
2025-05-08 21:50:33,713 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 22:20:14,592 - CtcTrainer - INFO - Running end-of-epoch 8 validation...
2025-05-08 22:20:16,346 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 22:20:16,347 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 22:20:16,347 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 22:20:16,347 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 22:20:16,347 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 22:20:16,347 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 22:20:16,347 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 22:20:16,347 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 22:20:16,347 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 22:20:16,347 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 22:20:16,347 - training.ctc_validation - INFO -   Prediction  : 'hver Gud ikkke boer. Hieter og i Kistt, e er dar erig'
2025-05-08 22:20:16,348 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 22:20:16,348 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 22:20:16,348 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 22:20:16,348 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 22:20:16,348 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 22:20:16,348 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 22:20:16,348 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 22:20:16,348 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-08 22:20:16,348 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 22:23:11,122 - training.ctc_validation - INFO - Validation Results: Loss=7.8410, CER=0.1693, WER=0.3982
2025-05-08 22:23:11,123 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 22:23:11,125 - CtcTrainer - INFO - --- Epoch 8/100 Summary ---
2025-05-08 22:23:11,125 - CtcTrainer - INFO - Avg Train Loss: 0.2918
2025-05-08 22:23:11,125 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.841003757680878, 'val_cer': 0.1692878341838632, 'val_wer': 0.39822321523566334}
2025-05-08 22:23:11,125 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1817
2025-05-08 22:23:11,125 - CtcTrainer - INFO - ---------------------
2025-05-08 22:23:11,129 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 22:23:12,940 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 22:23:12,941 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 22:23:14,639 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 22:23:14,639 - CtcTrainer - INFO - New best metric (val_cer) at epoch 8: 0.1693
2025-05-08 22:23:14,644 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 22:23:14,646 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 22:23:14,649 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 22:23:15,444 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 22:23:15,445 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 22:23:16,065 - CtcTrainer - INFO - Starting Epoch 9/100
2025-05-08 22:40:56,769 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 23:03:51,643 - CtcTrainer - INFO - Running end-of-epoch 9 validation...
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 23:03:53,396 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 23:03:53,396 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 23:03:53,396 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 23:03:53,396 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 23:03:53,396 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 23:03:53,396 - training.ctc_validation - INFO -   Prediction  : 'hver Gud ikke boe i jeteer og iHuset, der erder evig'
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:03:53,396 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 23:03:53,397 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 23:03:53,397 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 23:03:53,397 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:03:53,397 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 23:03:53,397 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 23:03:53,397 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-08 23:03:53,397 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:06:47,671 - training.ctc_validation - INFO - Validation Results: Loss=7.4247, CER=0.1613, WER=0.3839
2025-05-08 23:06:47,672 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 23:06:47,675 - CtcTrainer - INFO - --- Epoch 9/100 Summary ---
2025-05-08 23:06:47,675 - CtcTrainer - INFO - Avg Train Loss: 0.2639
2025-05-08 23:06:47,675 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.424745797978716, 'val_cer': 0.1612695807811439, 'val_wer': 0.3839344611128844}
2025-05-08 23:06:47,675 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1693
2025-05-08 23:06:47,675 - CtcTrainer - INFO - ---------------------
2025-05-08 23:06:47,677 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 23:06:49,218 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 23:06:49,219 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 23:06:50,731 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 23:06:50,731 - CtcTrainer - INFO - New best metric (val_cer) at epoch 9: 0.1613
2025-05-08 23:06:50,736 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 23:06:50,736 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 23:06:50,739 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 23:06:51,437 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 23:06:51,438 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 23:06:51,903 - CtcTrainer - INFO - Starting Epoch 10/100
2025-05-08 23:18:25,680 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-08 23:47:26,763 - CtcTrainer - INFO - Running end-of-epoch 10 validation...
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Prediction  : 'hever Gud ikke bor. Hiter og  Hudt, der erder evig'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:47:28,691 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-08 23:47:28,691 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-08 23:47:28,692 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-08 23:47:28,692 - training.ctc_validation - INFO - ---------------------------------
2025-05-08 23:50:21,827 - training.ctc_validation - INFO - Validation Results: Loss=7.2371, CER=0.1549, WER=0.3780
2025-05-08 23:50:21,827 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-08 23:50:21,829 - CtcTrainer - INFO - --- Epoch 10/100 Summary ---
2025-05-08 23:50:21,829 - CtcTrainer - INFO - Avg Train Loss: 0.2444
2025-05-08 23:50:21,830 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 7.237067727865392, 'val_cer': 0.15488040998178979, 'val_wer': 0.3779551016065539}
2025-05-08 23:50:21,830 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1613
2025-05-08 23:50:21,830 - CtcTrainer - INFO - ---------------------
2025-05-08 23:50:21,832 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-08 23:50:23,638 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-08 23:50:23,639 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-08 23:50:25,501 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-08 23:50:25,501 - CtcTrainer - INFO - New best metric (val_cer) at epoch 10: 0.1549
2025-05-08 23:50:25,504 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 23:50:25,506 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 23:50:25,510 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-08 23:50:26,247 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-08 23:50:26,247 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-08 23:50:26,812 - CtcTrainer - INFO - Starting Epoch 11/100
2025-05-09 00:25:51,754 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 00:30:59,421 - CtcTrainer - INFO - Running end-of-epoch 11 validation...
2025-05-09 00:31:01,370 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 00:31:01,370 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 00:31:01,370 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 00:31:01,370 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 00:31:01,370 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 00:31:01,370 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 00:31:01,370 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 00:31:01,370 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 00:31:01,370 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 00:31:01,370 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 00:31:01,371 - training.ctc_validation - INFO -   Prediction  : 'hver Gud ike bor. Hjeter og i Huset, der er dor evig'
2025-05-09 00:31:01,371 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 00:31:01,371 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 00:31:01,371 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 00:31:01,371 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 00:31:01,371 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 00:31:01,371 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 00:31:01,371 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 00:31:01,371 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 00:31:01,371 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 00:33:56,062 - training.ctc_validation - INFO - Validation Results: Loss=6.4894, CER=0.1399, WER=0.3457
2025-05-09 00:33:56,063 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 00:33:56,065 - CtcTrainer - INFO - --- Epoch 11/100 Summary ---
2025-05-09 00:33:56,065 - CtcTrainer - INFO - Avg Train Loss: 0.2257
2025-05-09 00:33:56,065 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.489426138448714, 'val_cer': 0.13987557551721574, 'val_wer': 0.3457176295350569}
2025-05-09 00:33:56,065 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1549
2025-05-09 00:33:56,065 - CtcTrainer - INFO - ---------------------
2025-05-09 00:33:56,067 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 00:33:57,720 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 00:33:57,720 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 00:34:00,019 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 00:34:00,020 - CtcTrainer - INFO - New best metric (val_cer) at epoch 11: 0.1399
2025-05-09 00:34:00,022 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 00:34:00,022 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 00:34:00,023 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 00:34:00,857 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 00:34:00,858 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 00:34:01,210 - CtcTrainer - INFO - Starting Epoch 12/100
2025-05-09 00:42:09,898 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 01:14:50,596 - CtcTrainer - INFO - Running end-of-epoch 12 validation...
2025-05-09 01:14:52,263 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Prediction  : 'hvr Gud ikle boer i Hjerner og i Hyset, der erder evig'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Prediction  : 'giàn'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 01:14:52,264 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:17:47,032 - training.ctc_validation - INFO - Validation Results: Loss=6.3890, CER=0.1387, WER=0.3405
2025-05-09 01:17:47,032 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 01:17:47,034 - CtcTrainer - INFO - --- Epoch 12/100 Summary ---
2025-05-09 01:17:47,035 - CtcTrainer - INFO - Avg Train Loss: 0.2106
2025-05-09 01:17:47,035 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.3890140962315645, 'val_cer': 0.13872634051425267, 'val_wer': 0.340461751250133}
2025-05-09 01:17:47,035 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1399
2025-05-09 01:17:47,035 - CtcTrainer - INFO - ---------------------
2025-05-09 01:17:47,037 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 01:17:48,724 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 01:17:48,725 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 01:17:50,605 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 01:17:50,607 - CtcTrainer - INFO - New best metric (val_cer) at epoch 12: 0.1387
2025-05-09 01:17:50,614 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 01:17:50,616 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 01:17:50,620 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 01:17:51,705 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 01:17:51,705 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 01:17:52,202 - CtcTrainer - INFO - Starting Epoch 13/100
2025-05-09 01:25:01,329 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 01:58:47,952 - CtcTrainer - INFO - Running end-of-epoch 13 validation...
2025-05-09 01:58:49,851 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 01:58:49,851 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 01:58:49,851 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 01:58:49,851 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:58:49,851 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 01:58:49,851 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 01:58:49,851 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 01:58:49,851 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:58:49,851 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 01:58:49,851 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 01:58:49,852 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke bver : Hjerter og  Mystt der ar der evig'
2025-05-09 01:58:49,852 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:58:49,852 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 01:58:49,852 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 01:58:49,852 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 01:58:49,852 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 01:58:49,852 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 01:58:49,852 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 01:58:49,852 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 01:58:49,852 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 02:01:44,896 - training.ctc_validation - INFO - Validation Results: Loss=6.4960, CER=0.1384, WER=0.3445
2025-05-09 02:01:44,896 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 02:01:44,898 - CtcTrainer - INFO - --- Epoch 13/100 Summary ---
2025-05-09 02:01:44,898 - CtcTrainer - INFO - Avg Train Loss: 0.2085
2025-05-09 02:01:44,898 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.495982971357743, 'val_cer': 0.13838564871796719, 'val_wer': 0.3444515373975955}
2025-05-09 02:01:44,898 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1387
2025-05-09 02:01:44,898 - CtcTrainer - INFO - ---------------------
2025-05-09 02:01:44,901 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 02:01:46,653 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 02:01:46,654 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 02:01:48,495 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 02:01:48,495 - CtcTrainer - INFO - New best metric (val_cer) at epoch 13: 0.1384
2025-05-09 02:01:48,498 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 02:01:48,500 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 02:01:48,504 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 02:01:49,301 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 02:01:49,301 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 02:01:49,907 - CtcTrainer - INFO - Starting Epoch 14/100
2025-05-09 02:16:04,499 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 02:43:21,430 - CtcTrainer - INFO - Running end-of-epoch 14 validation...
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Prediction  : 'hvr Gile ikke boei Hjeter og i Hyset, der er  der evig'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 02:43:23,474 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 02:46:18,739 - training.ctc_validation - INFO - Validation Results: Loss=6.3560, CER=0.1342, WER=0.3379
2025-05-09 02:46:18,739 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 02:46:18,741 - CtcTrainer - INFO - --- Epoch 14/100 Summary ---
2025-05-09 02:46:18,741 - CtcTrainer - INFO - Avg Train Loss: 0.1969
2025-05-09 02:46:18,742 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.355991281738215, 'val_cer': 0.13418458297644667, 'val_wer': 0.3378763698265773}
2025-05-09 02:46:18,742 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1384
2025-05-09 02:46:18,742 - CtcTrainer - INFO - ---------------------
2025-05-09 02:46:18,744 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 02:46:20,609 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 02:46:20,610 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 02:46:22,445 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 02:46:22,445 - CtcTrainer - INFO - New best metric (val_cer) at epoch 14: 0.1342
2025-05-09 02:46:22,449 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 02:46:22,450 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 02:46:22,454 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 02:46:23,247 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 02:46:23,247 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 02:46:23,603 - CtcTrainer - INFO - Starting Epoch 15/100
2025-05-09 03:00:41,526 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 03:27:25,309 - CtcTrainer - INFO - Running end-of-epoch 15 validation...
2025-05-09 03:27:27,197 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 03:27:27,197 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 03:27:27,197 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 03:27:27,197 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ike boer i Herter eor i Hust, der ar dor evig'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 03:27:27,198 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 03:30:22,230 - training.ctc_validation - INFO - Validation Results: Loss=6.0537, CER=0.1287, WER=0.3261
2025-05-09 03:30:22,230 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 03:30:22,233 - CtcTrainer - INFO - --- Epoch 15/100 Summary ---
2025-05-09 03:30:22,233 - CtcTrainer - INFO - Avg Train Loss: 0.1908
2025-05-09 03:30:22,233 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.0536891740590475, 'val_cer': 0.12870232414185254, 'val_wer': 0.326098521119268}
2025-05-09 03:30:22,233 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1342
2025-05-09 03:30:22,233 - CtcTrainer - INFO - ---------------------
2025-05-09 03:30:22,236 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 03:30:23,925 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 03:30:23,926 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 03:30:25,578 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 03:30:25,579 - CtcTrainer - INFO - New best metric (val_cer) at epoch 15: 0.1287
2025-05-09 03:30:25,585 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 03:30:25,586 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 03:30:25,588 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 03:30:26,307 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 03:30:26,307 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 03:30:26,809 - CtcTrainer - INFO - Starting Epoch 16/100
2025-05-09 03:56:49,581 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 04:11:19,825 - CtcTrainer - INFO - Running end-of-epoch 16 validation...
2025-05-09 04:11:21,707 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 04:11:21,708 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 04:11:21,708 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 04:11:21,708 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:11:21,708 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 04:11:21,708 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 04:11:21,708 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 04:11:21,708 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:11:21,708 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 04:11:21,708 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 04:11:21,708 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke ber i Hjjerter og i Husset, der ar deevis'
2025-05-09 04:11:21,708 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:11:21,708 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 04:11:21,709 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 04:11:21,709 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 04:11:21,709 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:11:21,709 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 04:11:21,709 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 04:11:21,709 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 04:11:21,709 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:14:16,334 - training.ctc_validation - INFO - Validation Results: Loss=6.0195, CER=0.1277, WER=0.3233
2025-05-09 04:14:16,335 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 04:14:16,337 - CtcTrainer - INFO - --- Epoch 16/100 Summary ---
2025-05-09 04:14:16,337 - CtcTrainer - INFO - Avg Train Loss: 0.1752
2025-05-09 04:14:16,337 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 6.019538352569995, 'val_cer': 0.12771863656102822, 'val_wer': 0.32331099053090756}
2025-05-09 04:14:16,337 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1287
2025-05-09 04:14:16,337 - CtcTrainer - INFO - ---------------------
2025-05-09 04:14:16,340 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 04:14:18,076 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 04:14:18,077 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 04:14:19,738 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 04:14:19,739 - CtcTrainer - INFO - New best metric (val_cer) at epoch 16: 0.1277
2025-05-09 04:14:19,743 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 04:14:19,744 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 04:14:19,746 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 04:14:20,510 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 04:14:20,510 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 04:14:20,842 - CtcTrainer - INFO - Starting Epoch 17/100
2025-05-09 04:34:09,162 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 04:54:47,747 - CtcTrainer - INFO - Running end-of-epoch 17 validation...
2025-05-09 04:54:49,568 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 04:54:49,568 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 04:54:49,568 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 04:54:49,568 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:54:49,568 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 04:54:49,568 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 04:54:49,568 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 04:54:49,568 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:54:49,569 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 04:54:49,569 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 04:54:49,569 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke bbver Hjerter og i Huset, der er der evig'
2025-05-09 04:54:49,569 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:54:49,569 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 04:54:49,569 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 04:54:49,569 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 04:54:49,569 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:54:49,569 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 04:54:49,569 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 04:54:49,569 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 04:54:49,569 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 04:57:43,755 - training.ctc_validation - INFO - Validation Results: Loss=5.9634, CER=0.1245, WER=0.3221
2025-05-09 04:57:43,755 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 04:57:43,757 - CtcTrainer - INFO - --- Epoch 17/100 Summary ---
2025-05-09 04:57:43,757 - CtcTrainer - INFO - Avg Train Loss: 0.1676
2025-05-09 04:57:43,758 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.963446050670194, 'val_cer': 0.12450845611433808, 'val_wer': 0.3221193744015321}
2025-05-09 04:57:43,758 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1277
2025-05-09 04:57:43,758 - CtcTrainer - INFO - ---------------------
2025-05-09 04:57:43,761 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 04:57:45,485 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 04:57:45,485 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 04:57:47,224 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 04:57:47,225 - CtcTrainer - INFO - New best metric (val_cer) at epoch 17: 0.1245
2025-05-09 04:57:47,229 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 04:57:47,229 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 04:57:47,232 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 04:57:48,030 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 04:57:48,030 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 04:57:48,375 - CtcTrainer - INFO - Starting Epoch 18/100
2025-05-09 05:04:18,041 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 05:38:11,173 - CtcTrainer - INFO - Running end-of-epoch 18 validation...
2025-05-09 05:38:12,990 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 05:38:12,990 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 05:38:12,990 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 05:38:12,990 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 05:38:12,990 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 05:38:12,990 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 05:38:12,990 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 05:38:12,990 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 05:38:12,990 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 05:38:12,990 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 05:38:12,990 - training.ctc_validation - INFO -   Prediction  : 'hver Gud ike bor i i Hjeter og i Huset, der er dar evig'
2025-05-09 05:38:12,991 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 05:38:12,991 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 05:38:12,991 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 05:38:12,991 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 05:38:12,991 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 05:38:12,991 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 05:38:12,991 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 05:38:12,991 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 05:38:12,991 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 05:41:06,957 - training.ctc_validation - INFO - Validation Results: Loss=5.8329, CER=0.1226, WER=0.3141
2025-05-09 05:41:06,957 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 05:41:06,959 - CtcTrainer - INFO - --- Epoch 18/100 Summary ---
2025-05-09 05:41:06,959 - CtcTrainer - INFO - Avg Train Loss: 0.1581
2025-05-09 05:41:06,959 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.8328581418738645, 'val_cer': 0.12262985275876381, 'val_wer': 0.3140653260985211}
2025-05-09 05:41:06,959 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1245
2025-05-09 05:41:06,959 - CtcTrainer - INFO - ---------------------
2025-05-09 05:41:06,961 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 05:41:08,636 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 05:41:08,636 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 05:41:10,322 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 05:41:10,323 - CtcTrainer - INFO - New best metric (val_cer) at epoch 18: 0.1226
2025-05-09 05:41:10,326 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 05:41:10,327 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 05:41:10,328 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 05:41:11,078 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 05:41:11,079 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 05:41:11,407 - CtcTrainer - INFO - Starting Epoch 19/100
2025-05-09 06:00:38,847 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 06:21:31,810 - CtcTrainer - INFO - Running end-of-epoch 19 validation...
2025-05-09 06:21:33,627 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 06:21:33,627 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 06:21:33,627 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 06:21:33,627 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 06:21:33,627 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 06:21:33,627 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huste der er der evig'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 06:21:33,628 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 06:24:28,523 - training.ctc_validation - INFO - Validation Results: Loss=5.8000, CER=0.1216, WER=0.3073
2025-05-09 06:24:28,524 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 06:24:28,526 - CtcTrainer - INFO - --- Epoch 19/100 Summary ---
2025-05-09 06:24:28,526 - CtcTrainer - INFO - Avg Train Loss: 0.1500
2025-05-09 06:24:28,526 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.80001212839485, 'val_cer': 0.12162217279791938, 'val_wer': 0.30726673050324504}
2025-05-09 06:24:28,526 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1226
2025-05-09 06:24:28,526 - CtcTrainer - INFO - ---------------------
2025-05-09 06:24:28,528 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 06:24:30,166 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 06:24:30,166 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 06:24:31,954 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 06:24:31,954 - CtcTrainer - INFO - New best metric (val_cer) at epoch 19: 0.1216
2025-05-09 06:24:31,958 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 06:24:31,959 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 06:24:31,961 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 06:24:32,713 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 06:24:32,713 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 06:24:33,078 - CtcTrainer - INFO - Starting Epoch 20/100
2025-05-09 06:24:42,476 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 07:04:55,866 - CtcTrainer - INFO - Running end-of-epoch 20 validation...
2025-05-09 07:04:57,736 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Herter og i Huset, der er dar evig'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 07:04:57,737 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:07:52,346 - training.ctc_validation - INFO - Validation Results: Loss=5.4733, CER=0.1129, WER=0.2910
2025-05-09 07:07:52,347 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 07:07:52,349 - CtcTrainer - INFO - --- Epoch 20/100 Summary ---
2025-05-09 07:07:52,349 - CtcTrainer - INFO - Avg Train Loss: 0.1441
2025-05-09 07:07:52,349 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.473331699462882, 'val_cer': 0.11291053961261903, 'val_wer': 0.29096712416214493}
2025-05-09 07:07:52,349 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1216
2025-05-09 07:07:52,349 - CtcTrainer - INFO - ---------------------
2025-05-09 07:07:52,351 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 07:07:54,001 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 07:07:54,002 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 07:07:55,739 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 07:07:55,740 - CtcTrainer - INFO - New best metric (val_cer) at epoch 20: 0.1129
2025-05-09 07:07:55,743 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 07:07:55,743 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 07:07:55,744 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 07:07:56,506 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 07:07:56,506 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 07:07:56,871 - CtcTrainer - INFO - Starting Epoch 21/100
2025-05-09 07:37:59,690 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 07:48:46,214 - CtcTrainer - INFO - Running end-of-epoch 21 validation...
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 07:48:48,058 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 07:48:48,058 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 07:48:48,058 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 07:48:48,058 - training.ctc_validation - INFO -   Prediction  : 'duật'
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 07:48:48,058 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 07:48:48,058 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke bor i Hjeter og i Huset, der ar dar evig'
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:48:48,058 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 07:48:48,059 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 07:48:48,059 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 07:48:48,059 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:48:48,059 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 07:48:48,059 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 07:48:48,059 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 07:48:48,059 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 07:51:43,341 - training.ctc_validation - INFO - Validation Results: Loss=5.8765, CER=0.1184, WER=0.3046
2025-05-09 07:51:43,342 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 07:51:43,344 - CtcTrainer - INFO - --- Epoch 21/100 Summary ---
2025-05-09 07:51:43,344 - CtcTrainer - INFO - Avg Train Loss: 0.1376
2025-05-09 07:51:43,345 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.876491367319163, 'val_cer': 0.11837120530519507, 'val_wer': 0.30463879136078303}
2025-05-09 07:51:43,345 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1129
2025-05-09 07:51:43,345 - CtcTrainer - INFO - ---------------------
2025-05-09 07:51:43,349 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 07:51:45,062 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 07:51:45,062 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-09 07:51:45,454 - CtcTrainer - INFO - Starting Epoch 22/100
2025-05-09 08:16:42,527 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 08:32:38,390 - CtcTrainer - INFO - Running end-of-epoch 22 validation...
2025-05-09 08:32:40,548 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Prediction  : 'hver Gud ike bor i Hjerter og i Hulet, der er der evig'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Prediction  : 'giàn'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 08:32:40,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 08:35:35,140 - training.ctc_validation - INFO - Validation Results: Loss=5.4100, CER=0.1097, WER=0.2839
2025-05-09 08:35:35,140 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 08:35:35,142 - CtcTrainer - INFO - --- Epoch 22/100 Summary ---
2025-05-09 08:35:35,142 - CtcTrainer - INFO - Avg Train Loss: 0.1313
2025-05-09 08:35:35,142 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.410043316414087, 'val_cer': 0.1096787660239108, 'val_wer': 0.2839131822534312}
2025-05-09 08:35:35,142 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1129
2025-05-09 08:35:35,142 - CtcTrainer - INFO - ---------------------
2025-05-09 08:35:35,145 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 08:35:36,821 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 08:35:36,821 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 08:35:38,488 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 08:35:38,488 - CtcTrainer - INFO - New best metric (val_cer) at epoch 22: 0.1097
2025-05-09 08:35:38,490 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 08:35:38,491 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 08:35:38,492 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 08:35:39,252 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 08:35:39,252 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 08:35:39,639 - CtcTrainer - INFO - Starting Epoch 23/100
2025-05-09 08:54:01,225 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 09:16:27,071 - CtcTrainer - INFO - Running end-of-epoch 23 validation...
2025-05-09 09:16:28,967 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 09:16:28,967 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 09:16:28,968 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 09:16:28,968 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 09:16:28,968 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 09:16:28,969 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 09:16:28,969 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 09:16:28,969 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 09:16:28,969 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 09:16:28,969 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 09:16:28,970 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikle ber i Hjerter og i Hesset, der ar der evig'
2025-05-09 09:16:28,970 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 09:16:28,970 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 09:16:28,970 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 09:16:28,970 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 09:16:28,970 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 09:16:28,970 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 09:16:28,971 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 09:16:28,971 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 09:16:28,971 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 09:19:23,921 - training.ctc_validation - INFO - Validation Results: Loss=5.2143, CER=0.1057, WER=0.2736
2025-05-09 09:19:23,921 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 09:19:23,924 - CtcTrainer - INFO - --- Epoch 23/100 Summary ---
2025-05-09 09:19:23,924 - CtcTrainer - INFO - Avg Train Loss: 0.1255
2025-05-09 09:19:23,924 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.214339689331787, 'val_cer': 0.10567443779855518, 'val_wer': 0.2736142142781147}
2025-05-09 09:19:23,924 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1097
2025-05-09 09:19:23,924 - CtcTrainer - INFO - ---------------------
2025-05-09 09:19:23,926 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 09:19:25,686 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 09:19:25,686 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 09:19:27,329 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 09:19:27,329 - CtcTrainer - INFO - New best metric (val_cer) at epoch 23: 0.1057
2025-05-09 09:19:27,332 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 09:19:27,333 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 09:19:27,335 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 09:19:28,115 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 09:19:28,115 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 09:19:28,487 - CtcTrainer - INFO - Starting Epoch 24/100
2025-05-09 09:25:38,002 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 10:00:11,357 - CtcTrainer - INFO - Running end-of-epoch 24 validation...
2025-05-09 10:00:13,341 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer  Hjerter og i Huset, de er der evig'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 10:00:13,342 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:03:08,139 - training.ctc_validation - INFO - Validation Results: Loss=5.2976, CER=0.1081, WER=0.2787
2025-05-09 10:03:08,140 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 10:03:08,142 - CtcTrainer - INFO - --- Epoch 24/100 Summary ---
2025-05-09 10:03:08,142 - CtcTrainer - INFO - Avg Train Loss: 0.1205
2025-05-09 10:03:08,142 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.29762643267644, 'val_cer': 0.10814565294062606, 'val_wer': 0.27871050111714013}
2025-05-09 10:03:08,142 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1057
2025-05-09 10:03:08,142 - CtcTrainer - INFO - ---------------------
2025-05-09 10:03:08,145 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 10:03:09,790 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 10:03:09,791 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-09 10:03:10,196 - CtcTrainer - INFO - Starting Epoch 25/100
2025-05-09 10:26:39,165 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 10:43:52,436 - CtcTrainer - INFO - Running end-of-epoch 25 validation...
2025-05-09 10:43:54,376 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 10:43:54,377 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 10:43:54,377 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 10:43:54,377 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:43:54,377 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 10:43:54,377 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 10:43:54,377 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 10:43:54,378 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:43:54,378 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 10:43:54,378 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 10:43:54,378 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke bor Hjerter og i Kuset, der er der evig'
2025-05-09 10:43:54,378 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:43:54,378 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 10:43:54,378 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 10:43:54,378 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 10:43:54,378 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:43:54,378 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 10:43:54,378 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 10:43:54,378 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 10:43:54,379 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 10:46:48,939 - training.ctc_validation - INFO - Validation Results: Loss=5.0012, CER=0.1001, WER=0.2657
2025-05-09 10:46:48,939 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 10:46:48,941 - CtcTrainer - INFO - --- Epoch 25/100 Summary ---
2025-05-09 10:46:48,941 - CtcTrainer - INFO - Avg Train Loss: 0.1155
2025-05-09 10:46:48,941 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.001220217280379, 'val_cer': 0.10006741858785649, 'val_wer': 0.26568783913182253}
2025-05-09 10:46:48,941 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1057
2025-05-09 10:46:48,941 - CtcTrainer - INFO - ---------------------
2025-05-09 10:46:48,943 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 10:46:50,648 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 10:46:50,649 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 10:46:52,327 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 10:46:52,327 - CtcTrainer - INFO - New best metric (val_cer) at epoch 25: 0.1001
2025-05-09 10:46:52,329 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 10:46:52,330 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 10:46:52,332 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 10:46:53,092 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 10:46:53,092 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 10:46:53,479 - CtcTrainer - INFO - Starting Epoch 26/100
2025-05-09 10:55:48,941 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 11:27:05,628 - CtcTrainer - INFO - Running end-of-epoch 26 validation...
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ike boer i Kjerter og i Husset, der er der evig'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 11:27:07,472 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 11:27:07,472 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 11:27:07,473 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 11:30:01,927 - training.ctc_validation - INFO - Validation Results: Loss=5.0902, CER=0.1022, WER=0.2725
2025-05-09 11:30:01,928 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 11:30:01,930 - CtcTrainer - INFO - --- Epoch 26/100 Summary ---
2025-05-09 11:30:01,930 - CtcTrainer - INFO - Avg Train Loss: 0.1063
2025-05-09 11:30:01,930 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.090186968769966, 'val_cer': 0.1021571548876077, 'val_wer': 0.27249707415682517}
2025-05-09 11:30:01,930 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1001
2025-05-09 11:30:01,930 - CtcTrainer - INFO - ---------------------
2025-05-09 11:30:01,933 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 11:30:03,737 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 11:30:03,738 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-09 11:30:04,132 - CtcTrainer - INFO - Starting Epoch 27/100
2025-05-09 11:37:39,713 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 12:10:18,510 - CtcTrainer - INFO - Running end-of-epoch 27 validation...
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Prediction  : 'hver Gud ikke bor i Hjerter og i Hujet, der er der evig'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:10:20,573 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 12:10:20,574 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 12:10:20,574 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 12:10:20,574 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:13:15,174 - training.ctc_validation - INFO - Validation Results: Loss=4.9492, CER=0.0977, WER=0.2563
2025-05-09 12:13:15,174 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 12:13:15,177 - CtcTrainer - INFO - --- Epoch 27/100 Summary ---
2025-05-09 12:13:15,177 - CtcTrainer - INFO - Avg Train Loss: 0.1064
2025-05-09 12:13:15,177 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.949195099985988, 'val_cer': 0.0977305607738982, 'val_wer': 0.25626130439408445}
2025-05-09 12:13:15,177 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.1001
2025-05-09 12:13:15,177 - CtcTrainer - INFO - ---------------------
2025-05-09 12:13:15,179 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 12:13:16,816 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 12:13:16,817 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 12:13:18,443 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 12:13:18,444 - CtcTrainer - INFO - New best metric (val_cer) at epoch 27: 0.0977
2025-05-09 12:13:18,447 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 12:13:18,448 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 12:13:18,449 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 12:13:19,195 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 12:13:19,195 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 12:13:19,525 - CtcTrainer - INFO - Starting Epoch 28/100
2025-05-09 12:28:56,545 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 12:53:37,468 - CtcTrainer - INFO - Running end-of-epoch 28 validation...
2025-05-09 12:53:39,247 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 12:53:39,247 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 12:53:39,247 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 12:53:39,247 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:53:39,247 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 12:53:39,247 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 12:53:39,247 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 12:53:39,247 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:53:39,247 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 12:53:39,247 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 12:53:39,247 - training.ctc_validation - INFO -   Prediction  : 'vvor Gud ikke boer i Hjerter og i Hult, der er der evig'
2025-05-09 12:53:39,247 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:53:39,248 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 12:53:39,248 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 12:53:39,248 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 12:53:39,248 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:53:39,248 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 12:53:39,248 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 12:53:39,248 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 12:53:39,248 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 12:56:34,029 - training.ctc_validation - INFO - Validation Results: Loss=4.7948, CER=0.0939, WER=0.2476
2025-05-09 12:56:34,030 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 12:56:34,032 - CtcTrainer - INFO - --- Epoch 28/100 Summary ---
2025-05-09 12:56:34,032 - CtcTrainer - INFO - Avg Train Loss: 0.1017
2025-05-09 12:56:34,032 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.794819378965989, 'val_cer': 0.09385579140065116, 'val_wer': 0.2475795297372061}
2025-05-09 12:56:34,032 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0977
2025-05-09 12:56:34,033 - CtcTrainer - INFO - ---------------------
2025-05-09 12:56:34,035 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 12:56:35,718 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 12:56:35,718 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 12:56:37,341 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 12:56:37,342 - CtcTrainer - INFO - New best metric (val_cer) at epoch 28: 0.0939
2025-05-09 12:56:37,345 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 12:56:37,346 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 12:56:37,348 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 12:56:38,120 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 12:56:38,120 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 12:56:38,466 - CtcTrainer - INFO - Starting Epoch 29/100
2025-05-09 13:27:47,986 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 13:36:57,619 - CtcTrainer - INFO - Running end-of-epoch 29 validation...
2025-05-09 13:36:59,573 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Prediction  : 'hvor Gued ikke boer. Hjerter og i Hudet, der er der evig'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Prediction  : 'giàn'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 13:36:59,574 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 13:39:54,136 - training.ctc_validation - INFO - Validation Results: Loss=4.7956, CER=0.0931, WER=0.2457
2025-05-09 13:39:54,137 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 13:39:54,139 - CtcTrainer - INFO - --- Epoch 29/100 Summary ---
2025-05-09 13:39:54,139 - CtcTrainer - INFO - Avg Train Loss: 0.0982
2025-05-09 13:39:54,139 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.795583464828156, 'val_cer': 0.09307603904999773, 'val_wer': 0.2456537929566975}
2025-05-09 13:39:54,139 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0939
2025-05-09 13:39:54,139 - CtcTrainer - INFO - ---------------------
2025-05-09 13:39:54,141 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 13:39:55,834 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 13:39:55,834 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 13:39:57,564 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 13:39:57,564 - CtcTrainer - INFO - New best metric (val_cer) at epoch 29: 0.0931
2025-05-09 13:39:57,567 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 13:39:57,568 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 13:39:57,570 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 13:39:59,109 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 13:39:59,110 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 13:39:59,432 - CtcTrainer - INFO - Starting Epoch 30/100
2025-05-09 14:15:41,716 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 14:20:42,408 - CtcTrainer - INFO - Running end-of-epoch 30 validation...
2025-05-09 14:20:44,140 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 14:20:44,140 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 14:20:44,140 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 14:20:44,140 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 14:20:44,140 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 14:20:44,140 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 14:20:44,141 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 14:23:38,428 - training.ctc_validation - INFO - Validation Results: Loss=4.6688, CER=0.0913, WER=0.2411
2025-05-09 14:23:38,428 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 14:23:38,430 - CtcTrainer - INFO - --- Epoch 30/100 Summary ---
2025-05-09 14:23:38,430 - CtcTrainer - INFO - Avg Train Loss: 0.0938
2025-05-09 14:23:38,430 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.668839206923608, 'val_cer': 0.09133419226053806, 'val_wer': 0.2410681987445473}
2025-05-09 14:23:38,430 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0931
2025-05-09 14:23:38,431 - CtcTrainer - INFO - ---------------------
2025-05-09 14:23:38,433 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 14:23:40,090 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 14:23:40,090 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 14:23:41,893 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 14:23:41,894 - CtcTrainer - INFO - New best metric (val_cer) at epoch 30: 0.0913
2025-05-09 14:23:41,898 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 14:23:41,899 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 14:23:41,900 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 14:23:42,647 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 14:23:42,647 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 14:23:43,020 - CtcTrainer - INFO - Starting Epoch 31/100
2025-05-09 14:54:28,286 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 15:04:18,878 - CtcTrainer - INFO - Running end-of-epoch 31 validation...
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:04:20,771 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 15:04:20,771 - training.ctc_validation - INFO -   Prediction  : 'giàn'
2025-05-09 15:04:20,772 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:04:20,772 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 15:04:20,772 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 15:04:20,772 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 15:04:20,772 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:07:14,935 - training.ctc_validation - INFO - Validation Results: Loss=5.4788, CER=0.1045, WER=0.2706
2025-05-09 15:07:14,935 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 15:07:14,938 - CtcTrainer - INFO - --- Epoch 31/100 Summary ---
2025-05-09 15:07:14,938 - CtcTrainer - INFO - Avg Train Loss: 0.0900
2025-05-09 15:07:14,938 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.478829274423383, 'val_cer': 0.10446762108354386, 'val_wer': 0.27059261623576975}
2025-05-09 15:07:14,938 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0913
2025-05-09 15:07:14,938 - CtcTrainer - INFO - ---------------------
2025-05-09 15:07:14,940 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 15:07:16,827 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 15:07:16,828 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-09 15:07:17,194 - CtcTrainer - INFO - Starting Epoch 32/100
2025-05-09 15:17:23,575 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 15:47:51,548 - CtcTrainer - INFO - Running end-of-epoch 32 validation...
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjjerter og i Husset, der ar der evig'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 15:47:53,566 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:47:53,567 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 15:47:53,567 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 15:47:53,567 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 15:47:53,567 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 15:50:48,022 - training.ctc_validation - INFO - Validation Results: Loss=4.7492, CER=0.0920, WER=0.2453
2025-05-09 15:50:48,023 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 15:50:48,025 - CtcTrainer - INFO - --- Epoch 32/100 Summary ---
2025-05-09 15:50:48,025 - CtcTrainer - INFO - Avg Train Loss: 0.0854
2025-05-09 15:50:48,025 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.749232072069194, 'val_cer': 0.09196279261706482, 'val_wer': 0.24526013405681454}
2025-05-09 15:50:48,025 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0913
2025-05-09 15:50:48,025 - CtcTrainer - INFO - ---------------------
2025-05-09 15:50:48,027 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 15:50:49,656 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 15:50:49,657 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-09 15:50:49,995 - CtcTrainer - INFO - Starting Epoch 33/100
2025-05-09 16:00:50,163 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 16:32:18,328 - CtcTrainer - INFO - Running end-of-epoch 33 validation...
2025-05-09 16:32:20,443 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 16:32:20,443 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 16:32:20,443 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 16:32:20,443 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 16:32:20,443 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 16:32:20,443 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 16:32:20,443 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 16:32:20,443 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 16:32:20,443 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 16:32:20,443 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 16:32:20,443 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke bo i Hjerter og i Huset, der er der evig'
2025-05-09 16:32:20,443 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 16:32:20,444 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 16:32:20,444 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 16:32:20,444 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 16:32:20,444 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 16:32:20,444 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 16:32:20,444 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 16:32:20,444 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 16:32:20,444 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 16:35:14,729 - training.ctc_validation - INFO - Validation Results: Loss=4.9174, CER=0.0930, WER=0.2467
2025-05-09 16:35:14,729 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 16:35:14,731 - CtcTrainer - INFO - --- Epoch 33/100 Summary ---
2025-05-09 16:35:14,732 - CtcTrainer - INFO - Avg Train Loss: 0.0854
2025-05-09 16:35:14,732 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.917358814055503, 'val_cer': 0.09299686419593137, 'val_wer': 0.2466858176401745}
2025-05-09 16:35:14,732 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0913
2025-05-09 16:35:14,732 - CtcTrainer - INFO - ---------------------
2025-05-09 16:35:14,734 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 16:35:17,095 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 16:35:17,096 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=10
2025-05-09 16:35:17,539 - CtcTrainer - INFO - Starting Epoch 34/100
2025-05-09 16:47:46,504 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 17:16:04,529 - CtcTrainer - INFO - Running end-of-epoch 34 validation...
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Prediction  : 'suột'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Hulet, der er der evig'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 17:16:06,269 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:19:00,138 - training.ctc_validation - INFO - Validation Results: Loss=4.8407, CER=0.0931, WER=0.2495
2025-05-09 17:19:00,139 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 17:19:00,142 - CtcTrainer - INFO - --- Epoch 34/100 Summary ---
2025-05-09 17:19:00,142 - CtcTrainer - INFO - Avg Train Loss: 0.0838
2025-05-09 17:19:00,142 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.840665795963529, 'val_cer': 0.09312162457203592, 'val_wer': 0.24951590594744122}
2025-05-09 17:19:00,142 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0913
2025-05-09 17:19:00,142 - CtcTrainer - INFO - ---------------------
2025-05-09 17:19:00,144 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 17:19:01,950 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 17:19:01,951 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=4, patience=10
2025-05-09 17:19:02,290 - CtcTrainer - INFO - Starting Epoch 35/100
2025-05-09 17:34:30,834 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 17:59:21,196 - CtcTrainer - INFO - Running end-of-epoch 35 validation...
2025-05-09 17:59:22,839 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 17:59:22,839 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 17:59:22,839 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Prediction  : 'hvor Gued ikke boer  Hjerter og i Huset, de er der evig'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 17:59:22,840 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 18:02:17,016 - training.ctc_validation - INFO - Validation Results: Loss=4.8570, CER=0.0902, WER=0.2403
2025-05-09 18:02:17,016 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 18:02:17,018 - CtcTrainer - INFO - --- Epoch 35/100 Summary ---
2025-05-09 18:02:17,018 - CtcTrainer - INFO - Avg Train Loss: 0.0838
2025-05-09 18:02:17,019 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.856996214089308, 'val_cer': 0.09023774049361923, 'val_wer': 0.2402702415150548}
2025-05-09 18:02:17,019 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0913
2025-05-09 18:02:17,019 - CtcTrainer - INFO - ---------------------
2025-05-09 18:02:17,021 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 18:02:18,783 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 18:02:18,783 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 18:02:20,530 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 18:02:20,531 - CtcTrainer - INFO - New best metric (val_cer) at epoch 35: 0.0902
2025-05-09 18:02:20,533 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 18:02:20,534 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 18:02:20,535 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 18:02:21,493 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 18:02:21,493 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 18:02:21,890 - CtcTrainer - INFO - Starting Epoch 36/100
2025-05-09 18:07:21,918 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 18:42:37,607 - CtcTrainer - INFO - Running end-of-epoch 36 validation...
2025-05-09 18:42:39,414 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 18:42:39,414 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ike boer i Hjerter og i Huset, der erder evig'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-09 18:42:39,415 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 18:45:47,674 - training.ctc_validation - INFO - Validation Results: Loss=4.9602, CER=0.0923, WER=0.2419
2025-05-09 18:45:47,674 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 18:45:47,676 - CtcTrainer - INFO - --- Epoch 36/100 Summary ---
2025-05-09 18:45:47,676 - CtcTrainer - INFO - Avg Train Loss: 0.0765
2025-05-09 18:45:47,676 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.960207184925384, 'val_cer': 0.09226509660531815, 'val_wer': 0.24185551654431323}
2025-05-09 18:45:47,676 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0902
2025-05-09 18:45:47,676 - CtcTrainer - INFO - ---------------------
2025-05-09 18:45:47,679 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 18:45:49,510 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 18:45:49,511 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-09 18:45:49,857 - CtcTrainer - INFO - Starting Epoch 37/100
2025-05-09 18:48:19,119 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 19:28:05,082 - CtcTrainer - INFO - Running end-of-epoch 37 validation...
2025-05-09 19:28:06,977 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 19:28:06,977 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 19:28:06,977 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 19:28:06,977 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 19:28:06,977 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 19:28:06,977 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 19:28:06,977 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 19:28:06,977 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 19:28:06,977 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 19:28:06,977 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 19:28:06,978 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer. i Hjerter gog i Huset, der erder evig'
2025-05-09 19:28:06,978 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 19:28:06,978 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 19:28:06,978 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 19:28:06,978 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 19:28:06,978 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 19:28:06,978 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 19:28:06,978 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 19:28:06,978 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 19:28:06,978 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 19:31:00,977 - training.ctc_validation - INFO - Validation Results: Loss=4.6223, CER=0.0861, WER=0.2290
2025-05-09 19:31:00,978 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 19:31:00,981 - CtcTrainer - INFO - --- Epoch 37/100 Summary ---
2025-05-09 19:31:00,981 - CtcTrainer - INFO - Avg Train Loss: 0.0731
2025-05-09 19:31:00,981 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.622342813530562, 'val_cer': 0.08613504351018117, 'val_wer': 0.2290030854346207}
2025-05-09 19:31:00,981 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0902
2025-05-09 19:31:00,981 - CtcTrainer - INFO - ---------------------
2025-05-09 19:31:00,985 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 19:31:02,976 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 19:31:02,976 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 19:31:04,796 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 19:31:04,797 - CtcTrainer - INFO - New best metric (val_cer) at epoch 37: 0.0861
2025-05-09 19:31:04,802 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 19:31:04,803 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 19:31:04,807 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 19:31:05,783 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 19:31:05,783 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 19:31:06,442 - CtcTrainer - INFO - Starting Epoch 38/100
2025-05-09 19:53:06,126 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 20:11:09,569 - CtcTrainer - INFO - Running end-of-epoch 38 validation...
2025-05-09 20:11:11,253 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 20:11:11,254 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 20:11:11,254 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 20:11:11,254 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:11:11,254 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 20:11:11,254 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 20:11:11,255 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 20:11:11,255 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:11:11,255 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 20:11:11,255 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 20:11:11,255 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Nuset, der er der evig'
2025-05-09 20:11:11,255 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:11:11,255 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 20:11:11,255 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 20:11:11,256 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 20:11:11,256 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:11:11,256 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 20:11:11,256 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 20:11:11,256 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 20:11:11,256 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:14:05,822 - training.ctc_validation - INFO - Validation Results: Loss=4.6909, CER=0.0857, WER=0.2300
2025-05-09 20:14:05,823 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 20:14:05,825 - CtcTrainer - INFO - --- Epoch 38/100 Summary ---
2025-05-09 20:14:05,825 - CtcTrainer - INFO - Avg Train Loss: 0.0700
2025-05-09 20:14:05,825 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.69089323226347, 'val_cer': 0.08565999438578308, 'val_wer': 0.2299606341100117}
2025-05-09 20:14:05,825 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0861
2025-05-09 20:14:05,825 - CtcTrainer - INFO - ---------------------
2025-05-09 20:14:05,828 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 20:14:07,614 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 20:14:07,614 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 20:14:09,388 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 20:14:09,389 - CtcTrainer - INFO - New best metric (val_cer) at epoch 38: 0.0857
2025-05-09 20:14:09,436 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 20:14:09,437 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 20:14:09,438 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 20:14:10,333 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 20:14:10,334 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 20:14:10,819 - CtcTrainer - INFO - Starting Epoch 39/100
2025-05-09 20:34:03,921 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 20:54:14,012 - CtcTrainer - INFO - Running end-of-epoch 39 validation...
2025-05-09 20:54:15,865 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 20:54:15,866 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 20:54:15,866 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 20:54:15,866 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:54:15,866 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 20:54:15,866 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 20:54:15,866 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 20:54:15,866 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:54:15,866 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 20:54:15,866 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 20:54:15,866 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer. Hjerter og i Husst, der er der evig'
2025-05-09 20:54:15,866 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:54:15,867 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 20:54:15,867 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 20:54:15,867 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 20:54:15,867 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:54:15,867 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 20:54:15,867 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 20:54:15,867 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 20:54:15,867 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 20:57:22,830 - training.ctc_validation - INFO - Validation Results: Loss=4.5657, CER=0.0824, WER=0.2203
2025-05-09 20:57:22,831 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 20:57:22,833 - CtcTrainer - INFO - --- Epoch 39/100 Summary ---
2025-05-09 20:57:22,833 - CtcTrainer - INFO - Avg Train Loss: 0.0656
2025-05-09 20:57:22,833 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.565746934000258, 'val_cer': 0.08236823984702459, 'val_wer': 0.22034258963719544}
2025-05-09 20:57:22,833 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0857
2025-05-09 20:57:22,833 - CtcTrainer - INFO - ---------------------
2025-05-09 20:57:22,837 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 20:57:24,772 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 20:57:24,772 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 20:57:26,624 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 20:57:26,625 - CtcTrainer - INFO - New best metric (val_cer) at epoch 39: 0.0824
2025-05-09 20:57:26,628 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 20:57:26,630 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 20:57:26,634 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 20:57:27,504 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 20:57:27,504 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 20:57:28,122 - CtcTrainer - INFO - Starting Epoch 40/100
2025-05-09 21:29:27,146 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 21:37:20,672 - CtcTrainer - INFO - Running end-of-epoch 40 validation...
2025-05-09 21:37:22,590 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 21:37:22,590 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 21:37:22,590 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 21:37:22,590 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 21:37:22,590 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 21:37:22,590 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 21:37:22,590 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 21:37:22,590 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 21:37:22,590 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 21:37:22,590 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 21:37:22,590 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer. i Hjerter og i Huset, der er der evig'
2025-05-09 21:37:22,590 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 21:37:22,591 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 21:37:22,591 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 21:37:22,591 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 21:37:22,591 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 21:37:22,591 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 21:37:22,591 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 21:37:22,591 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 21:37:22,591 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 21:40:17,072 - training.ctc_validation - INFO - Validation Results: Loss=4.6325, CER=0.0826, WER=0.2248
2025-05-09 21:40:17,072 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 21:40:17,075 - CtcTrainer - INFO - --- Epoch 40/100 Summary ---
2025-05-09 21:40:17,075 - CtcTrainer - INFO - Avg Train Loss: 0.0640
2025-05-09 21:40:17,075 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.632476325666168, 'val_cer': 0.0825529811731794, 'val_wer': 0.22475795297372061}
2025-05-09 21:40:17,075 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0824
2025-05-09 21:40:17,075 - CtcTrainer - INFO - ---------------------
2025-05-09 21:40:17,077 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 21:40:18,541 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 21:40:18,541 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-09 21:40:18,873 - CtcTrainer - INFO - Starting Epoch 41/100
2025-05-09 21:40:40,589 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 22:20:20,173 - CtcTrainer - INFO - Running end-of-epoch 41 validation...
2025-05-09 22:20:21,875 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 22:20:21,875 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 22:20:21,875 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 22:20:21,875 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 22:20:21,875 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 22:20:21,875 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Prediction  : 'giàn'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 22:20:21,876 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 22:23:16,868 - training.ctc_validation - INFO - Validation Results: Loss=4.6286, CER=0.0814, WER=0.2202
2025-05-09 22:23:16,868 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 22:23:16,870 - CtcTrainer - INFO - --- Epoch 41/100 Summary ---
2025-05-09 22:23:16,870 - CtcTrainer - INFO - Avg Train Loss: 0.0597
2025-05-09 22:23:16,870 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.628555887872065, 'val_cer': 0.0813725560761902, 'val_wer': 0.22024683476965634}
2025-05-09 22:23:16,870 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0824
2025-05-09 22:23:16,870 - CtcTrainer - INFO - ---------------------
2025-05-09 22:23:16,873 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 22:23:18,794 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 22:23:18,794 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 22:23:19,946 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 22:23:19,947 - CtcTrainer - INFO - New best metric (val_cer) at epoch 41: 0.0814
2025-05-09 22:23:19,949 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 22:23:19,950 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 22:23:19,951 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 22:23:21,348 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 22:23:21,348 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 22:23:21,747 - CtcTrainer - INFO - Starting Epoch 42/100
2025-05-09 22:30:56,110 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 23:03:30,365 - CtcTrainer - INFO - Running end-of-epoch 42 validation...
2025-05-09 23:03:32,172 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 23:03:32,172 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 23:03:32,172 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 23:03:32,172 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:03:32,172 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 23:03:32,172 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 23:03:32,172 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-09 23:03:32,172 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:03:32,172 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 23:03:32,172 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 23:03:32,172 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huet, der er der evig'
2025-05-09 23:03:32,172 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:03:32,173 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 23:03:32,173 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 23:03:32,173 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 23:03:32,173 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:03:32,173 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 23:03:32,173 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 23:03:32,173 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 23:03:32,173 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:06:26,630 - training.ctc_validation - INFO - Validation Results: Loss=4.4468, CER=0.0801, WER=0.2175
2025-05-09 23:06:26,631 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 23:06:26,633 - CtcTrainer - INFO - --- Epoch 42/100 Summary ---
2025-05-09 23:06:26,633 - CtcTrainer - INFO - Avg Train Loss: 0.0570
2025-05-09 23:06:26,633 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.446783813547564, 'val_cer': 0.08007216907910047, 'val_wer': 0.21746994361102245}
2025-05-09 23:06:26,633 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0814
2025-05-09 23:06:26,634 - CtcTrainer - INFO - ---------------------
2025-05-09 23:06:26,636 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 23:06:28,545 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 23:06:28,547 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 23:06:30,454 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 23:06:30,455 - CtcTrainer - INFO - New best metric (val_cer) at epoch 42: 0.0801
2025-05-09 23:06:30,460 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 23:06:30,461 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 23:06:30,463 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 23:06:31,221 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 23:06:31,221 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 23:06:31,625 - CtcTrainer - INFO - Starting Epoch 43/100
2025-05-09 23:13:35,017 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-09 23:47:02,017 - CtcTrainer - INFO - Running end-of-epoch 43 validation...
2025-05-09 23:47:04,107 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-09 23:47:04,107 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-09 23:47:04,107 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer, i Hjerter og i Hyset, der er der evig'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-09 23:47:04,108 - training.ctc_validation - INFO - ---------------------------------
2025-05-09 23:49:59,052 - training.ctc_validation - INFO - Validation Results: Loss=4.5091, CER=0.0796, WER=0.2161
2025-05-09 23:49:59,052 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-09 23:49:59,054 - CtcTrainer - INFO - --- Epoch 43/100 Summary ---
2025-05-09 23:49:59,054 - CtcTrainer - INFO - Avg Train Loss: 0.0546
2025-05-09 23:49:59,054 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.509131717757559, 'val_cer': 0.07956353062267424, 'val_wer': 0.21612937546547506}
2025-05-09 23:49:59,054 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0801
2025-05-09 23:49:59,054 - CtcTrainer - INFO - ---------------------
2025-05-09 23:49:59,057 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-09 23:50:00,881 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-09 23:50:00,882 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-09 23:50:02,695 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-09 23:50:02,696 - CtcTrainer - INFO - New best metric (val_cer) at epoch 43: 0.0796
2025-05-09 23:50:02,698 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 23:50:02,698 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 23:50:02,699 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-09 23:50:03,408 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-09 23:50:03,409 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-09 23:50:03,808 - CtcTrainer - INFO - Starting Epoch 44/100
2025-05-10 00:24:08,518 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 00:30:11,690 - CtcTrainer - INFO - Running end-of-epoch 44 validation...
2025-05-10 00:30:13,256 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 00:30:13,256 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 00:30:13,256 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 00:30:13,256 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 00:30:13,256 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 00:30:13,256 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 00:30:13,256 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 00:30:13,256 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 00:30:13,256 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 00:30:13,256 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 00:30:13,256 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og Husset, der er der evig'
2025-05-10 00:30:13,256 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 00:30:13,257 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 00:30:13,257 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 00:30:13,257 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 00:30:13,257 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 00:30:13,257 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 00:30:13,257 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 00:30:13,257 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 00:30:13,257 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 00:33:08,024 - training.ctc_validation - INFO - Validation Results: Loss=4.6521, CER=0.0801, WER=0.2161
2025-05-10 00:33:08,024 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 00:33:08,026 - CtcTrainer - INFO - --- Epoch 44/100 Summary ---
2025-05-10 00:33:08,026 - CtcTrainer - INFO - Avg Train Loss: 0.0545
2025-05-10 00:33:08,026 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.652066952968018, 'val_cer': 0.08014174698115878, 'val_wer': 0.21612937546547506}
2025-05-10 00:33:08,026 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0796
2025-05-10 00:33:08,027 - CtcTrainer - INFO - ---------------------
2025-05-10 00:33:08,029 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 00:33:09,741 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 00:33:09,742 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 00:33:10,088 - CtcTrainer - INFO - Starting Epoch 45/100
2025-05-10 00:47:49,992 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 01:14:49,355 - CtcTrainer - INFO - Running end-of-epoch 45 validation...
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boe i Hjerter og i Huset, der erder evig'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:14:51,142 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 01:14:51,143 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 01:14:51,143 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 01:14:51,143 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:18:15,466 - training.ctc_validation - INFO - Validation Results: Loss=4.4228, CER=0.0776, WER=0.2114
2025-05-10 01:18:15,466 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 01:18:15,468 - CtcTrainer - INFO - --- Epoch 45/100 Summary ---
2025-05-10 01:18:15,469 - CtcTrainer - INFO - Avg Train Loss: 0.0502
2025-05-10 01:18:15,469 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.422763965666873, 'val_cer': 0.0775529691769894, 'val_wer': 0.21137355037769975}
2025-05-10 01:18:15,469 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0796
2025-05-10 01:18:15,469 - CtcTrainer - INFO - ---------------------
2025-05-10 01:18:15,471 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 01:18:17,096 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 01:18:17,096 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 01:18:20,126 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 01:18:20,126 - CtcTrainer - INFO - New best metric (val_cer) at epoch 45: 0.0776
2025-05-10 01:18:20,129 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 01:18:20,131 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 01:18:20,132 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 01:18:21,197 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 01:18:21,197 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 01:18:21,562 - CtcTrainer - INFO - Starting Epoch 46/100
2025-05-10 01:31:22,503 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 01:58:29,645 - CtcTrainer - INFO - Running end-of-epoch 46 validation...
2025-05-10 01:58:31,494 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 01:58:31,494 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 01:58:31,494 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 01:58:31,494 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:58:31,494 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 01:58:31,494 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Hust, der er der evig'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 01:58:31,495 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 02:01:25,822 - training.ctc_validation - INFO - Validation Results: Loss=4.4739, CER=0.0766, WER=0.2064
2025-05-10 02:01:25,822 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 02:01:25,824 - CtcTrainer - INFO - --- Epoch 46/100 Summary ---
2025-05-10 02:01:25,824 - CtcTrainer - INFO - Avg Train Loss: 0.0489
2025-05-10 02:01:25,824 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.47392140485881, 'val_cer': 0.07659807245218918, 'val_wer': 0.20640493669539312}
2025-05-10 02:01:25,825 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0776
2025-05-10 02:01:25,825 - CtcTrainer - INFO - ---------------------
2025-05-10 02:01:25,829 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 02:01:27,589 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 02:01:27,589 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 02:01:29,435 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 02:01:29,435 - CtcTrainer - INFO - New best metric (val_cer) at epoch 46: 0.0766
2025-05-10 02:01:29,439 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 02:01:29,440 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 02:01:29,442 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 02:01:30,324 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 02:01:30,324 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 02:01:30,713 - CtcTrainer - INFO - Starting Epoch 47/100
2025-05-10 02:17:40,741 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 02:41:24,154 - CtcTrainer - INFO - Running end-of-epoch 47 validation...
2025-05-10 02:41:25,844 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 02:41:25,844 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 02:41:25,844 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 02:41:25,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 02:41:25,844 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 02:41:25,844 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 02:41:25,844 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 02:41:25,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 02:41:25,844 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 02:41:25,844 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 02:41:25,844 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Husset, der er der evig'
2025-05-10 02:41:25,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 02:41:25,845 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 02:41:25,845 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 02:41:25,845 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 02:41:25,845 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 02:41:25,845 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 02:41:25,845 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 02:41:25,845 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 02:41:25,845 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 02:44:20,175 - training.ctc_validation - INFO - Validation Results: Loss=4.5062, CER=0.0776, WER=0.2101
2025-05-10 02:44:20,176 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 02:44:20,178 - CtcTrainer - INFO - --- Epoch 47/100 Summary ---
2025-05-10 02:44:20,178 - CtcTrainer - INFO - Avg Train Loss: 0.0453
2025-05-10 02:44:20,178 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.506248945121034, 'val_cer': 0.07763214403105574, 'val_wer': 0.21006490052133206}
2025-05-10 02:44:20,178 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0766
2025-05-10 02:44:20,178 - CtcTrainer - INFO - ---------------------
2025-05-10 02:44:20,180 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 02:44:22,132 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 02:44:22,133 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 02:44:22,518 - CtcTrainer - INFO - Starting Epoch 48/100
2025-05-10 02:53:45,327 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 03:24:22,252 - CtcTrainer - INFO - Running end-of-epoch 48 validation...
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer Hjerter og i Huset, der er err evig'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 03:24:24,192 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 03:24:24,193 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 03:24:24,193 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 03:24:24,193 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 03:24:24,193 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 03:27:18,463 - training.ctc_validation - INFO - Validation Results: Loss=4.8156, CER=0.0812, WER=0.2176
2025-05-10 03:27:18,463 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 03:27:18,465 - CtcTrainer - INFO - --- Epoch 48/100 Summary ---
2025-05-10 03:27:18,466 - CtcTrainer - INFO - Avg Train Loss: 0.0450
2025-05-10 03:27:18,466 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.815552675912022, 'val_cer': 0.08124779570008565, 'val_wer': 0.21760825619746782}
2025-05-10 03:27:18,466 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0766
2025-05-10 03:27:18,466 - CtcTrainer - INFO - ---------------------
2025-05-10 03:27:18,468 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 03:27:20,045 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 03:27:20,045 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-10 03:27:20,421 - CtcTrainer - INFO - Starting Epoch 49/100
2025-05-10 03:46:01,924 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 04:09:28,400 - CtcTrainer - INFO - Running end-of-epoch 49 validation...
2025-05-10 04:09:30,250 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 04:09:30,250 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 04:09:30,250 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 04:09:30,250 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:09:30,250 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 04:09:30,250 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 04:09:30,250 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 04:09:30,250 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:09:30,250 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 04:09:30,250 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 04:09:30,251 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der erder evig'
2025-05-10 04:09:30,251 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:09:30,251 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 04:09:30,251 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 04:09:30,251 - training.ctc_validation - INFO -   Prediction  : 'giàn'
2025-05-10 04:09:30,251 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:09:30,251 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 04:09:30,251 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 04:09:30,251 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 04:09:30,251 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:13:06,627 - training.ctc_validation - INFO - Validation Results: Loss=4.3217, CER=0.0725, WER=0.1985
2025-05-10 04:13:06,627 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 04:13:06,629 - CtcTrainer - INFO - --- Epoch 49/100 Summary ---
2025-05-10 04:13:06,629 - CtcTrainer - INFO - Avg Train Loss: 0.0437
2025-05-10 04:13:06,629 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.321677801698195, 'val_cer': 0.07245218918471494, 'val_wer': 0.19851047983828066}
2025-05-10 04:13:06,629 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0766
2025-05-10 04:13:06,629 - CtcTrainer - INFO - ---------------------
2025-05-10 04:13:06,631 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 04:13:08,334 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 04:13:08,335 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 04:13:10,294 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 04:13:10,295 - CtcTrainer - INFO - New best metric (val_cer) at epoch 49: 0.0725
2025-05-10 04:13:10,297 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 04:13:10,297 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 04:13:10,298 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 04:13:11,126 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 04:13:11,126 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 04:13:11,516 - CtcTrainer - INFO - Starting Epoch 50/100
2025-05-10 04:34:18,823 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 04:54:17,675 - CtcTrainer - INFO - Running end-of-epoch 50 validation...
2025-05-10 04:54:19,478 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 04:54:19,479 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 04:54:19,479 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 04:54:19,479 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:54:19,479 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 04:54:19,479 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 04:54:19,479 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 04:54:19,479 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:54:19,479 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 04:54:19,479 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 04:54:19,479 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 04:54:19,479 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:54:19,479 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 04:54:19,480 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 04:54:19,480 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 04:54:19,480 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:54:19,480 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 04:54:19,480 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 04:54:19,480 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 04:54:19,480 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 04:57:14,479 - training.ctc_validation - INFO - Validation Results: Loss=4.4459, CER=0.0754, WER=0.2055
2025-05-10 04:57:14,480 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 04:57:14,483 - CtcTrainer - INFO - --- Epoch 50/100 Summary ---
2025-05-10 04:57:14,483 - CtcTrainer - INFO - Avg Train Loss: 0.0411
2025-05-10 04:57:14,483 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.445910854189672, 'val_cer': 0.07542484506920602, 'val_wer': 0.20554314288754122}
2025-05-10 04:57:14,483 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0725
2025-05-10 04:57:14,483 - CtcTrainer - INFO - ---------------------
2025-05-10 04:57:14,487 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 04:57:16,423 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 04:57:16,423 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 04:57:17,080 - CtcTrainer - INFO - Starting Epoch 51/100
2025-05-10 05:16:09,938 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 05:38:25,578 - CtcTrainer - INFO - Running end-of-epoch 51 validation...
2025-05-10 05:38:27,302 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 05:38:27,303 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 05:38:27,303 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 05:38:27,303 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 05:38:27,303 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 05:38:27,303 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 05:38:27,303 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 05:38:27,303 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 05:38:27,303 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 05:38:27,303 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 05:38:27,303 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boe i Hjerter og i Huset, der er der evig'
2025-05-10 05:38:27,303 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 05:38:27,303 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 05:38:27,304 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 05:38:27,304 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 05:38:27,304 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 05:38:27,304 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 05:38:27,304 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 05:38:27,304 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 05:38:27,304 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 05:41:27,731 - training.ctc_validation - INFO - Validation Results: Loss=4.4313, CER=0.0705, WER=0.1922
2025-05-10 05:41:27,732 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 05:41:27,734 - CtcTrainer - INFO - --- Epoch 51/100 Summary ---
2025-05-10 05:41:27,734 - CtcTrainer - INFO - Avg Train Loss: 0.0419
2025-05-10 05:41:27,734 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.4313227683902685, 'val_cer': 0.07051600411709241, 'val_wer': 0.19223321629960635}
2025-05-10 05:41:27,734 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0725
2025-05-10 05:41:27,734 - CtcTrainer - INFO - ---------------------
2025-05-10 05:41:27,736 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 05:41:29,466 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 05:41:29,466 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 05:41:31,212 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 05:41:31,212 - CtcTrainer - INFO - New best metric (val_cer) at epoch 51: 0.0705
2025-05-10 05:41:31,214 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 05:41:31,215 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 05:41:31,216 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 05:41:32,001 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 05:41:32,002 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 05:41:32,376 - CtcTrainer - INFO - Starting Epoch 52/100
2025-05-10 06:02:32,775 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 06:22:23,548 - CtcTrainer - INFO - Running end-of-epoch 52 validation...
2025-05-10 06:22:25,287 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 06:22:25,288 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 06:22:25,288 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 06:22:25,289 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 06:22:25,289 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 06:25:32,020 - training.ctc_validation - INFO - Validation Results: Loss=4.6121, CER=0.0746, WER=0.2002
2025-05-10 06:25:32,021 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 06:25:32,024 - CtcTrainer - INFO - --- Epoch 52/100 Summary ---
2025-05-10 06:25:32,024 - CtcTrainer - INFO - Avg Train Loss: 0.0366
2025-05-10 06:25:32,024 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.612090156577574, 'val_cer': 0.07460670491052042, 'val_wer': 0.2002234280242579}
2025-05-10 06:25:32,024 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0705
2025-05-10 06:25:32,024 - CtcTrainer - INFO - ---------------------
2025-05-10 06:25:32,029 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 06:25:33,923 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 06:25:33,923 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 06:25:34,537 - CtcTrainer - INFO - Starting Epoch 53/100
2025-05-10 06:52:13,540 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 07:06:33,438 - CtcTrainer - INFO - Running end-of-epoch 53 validation...
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i. Hjerter og i Huset, der er der evig'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 07:06:35,230 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:09:31,125 - training.ctc_validation - INFO - Validation Results: Loss=4.4239, CER=0.0703, WER=0.1912
2025-05-10 07:09:31,126 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 07:09:31,128 - CtcTrainer - INFO - --- Epoch 53/100 Summary ---
2025-05-10 07:09:31,128 - CtcTrainer - INFO - Avg Train Loss: 0.0340
2025-05-10 07:09:31,128 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.423904928290338, 'val_cer': 0.07029527422090744, 'val_wer': 0.1911905521864028}
2025-05-10 07:09:31,128 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0705
2025-05-10 07:09:31,128 - CtcTrainer - INFO - ---------------------
2025-05-10 07:09:31,130 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 07:09:32,788 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 07:09:32,789 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 07:09:34,450 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 07:09:34,450 - CtcTrainer - INFO - New best metric (val_cer) at epoch 53: 0.0703
2025-05-10 07:09:34,453 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 07:09:34,454 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 07:09:34,457 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 07:09:35,317 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 07:09:35,317 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 07:09:35,654 - CtcTrainer - INFO - Starting Epoch 54/100
2025-05-10 07:26:15,030 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 07:50:24,227 - CtcTrainer - INFO - Running end-of-epoch 54 validation...
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 07:50:26,153 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 07:53:21,552 - training.ctc_validation - INFO - Validation Results: Loss=4.2779, CER=0.0688, WER=0.1897
2025-05-10 07:53:21,552 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 07:53:21,557 - CtcTrainer - INFO - --- Epoch 54/100 Summary ---
2025-05-10 07:53:21,557 - CtcTrainer - INFO - Avg Train Loss: 0.0316
2025-05-10 07:53:21,557 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.277905231935394, 'val_cer': 0.06881254513566491, 'val_wer': 0.1896903925949569}
2025-05-10 07:53:21,558 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0703
2025-05-10 07:53:21,558 - CtcTrainer - INFO - ---------------------
2025-05-10 07:53:21,560 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 07:53:23,360 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 07:53:23,360 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 07:53:25,047 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 07:53:25,047 - CtcTrainer - INFO - New best metric (val_cer) at epoch 54: 0.0688
2025-05-10 07:53:25,053 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 07:53:25,054 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 07:53:25,057 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 07:53:25,910 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 07:53:25,911 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 07:53:26,244 - CtcTrainer - INFO - Starting Epoch 55/100
2025-05-10 08:06:18,321 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 08:34:05,173 - CtcTrainer - INFO - Running end-of-epoch 55 validation...
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 08:34:07,018 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 08:34:07,018 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 08:34:07,019 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 08:37:01,678 - training.ctc_validation - INFO - Validation Results: Loss=4.3035, CER=0.0669, WER=0.1824
2025-05-10 08:37:01,678 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 08:37:01,681 - CtcTrainer - INFO - --- Epoch 55/100 Summary ---
2025-05-10 08:37:01,681 - CtcTrainer - INFO - Avg Train Loss: 0.0300
2025-05-10 08:37:01,681 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.303503463520311, 'val_cer': 0.06691954635207858, 'val_wer': 0.18240238323225874}
2025-05-10 08:37:01,681 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0688
2025-05-10 08:37:01,681 - CtcTrainer - INFO - ---------------------
2025-05-10 08:37:01,683 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 08:37:03,554 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 08:37:03,554 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 08:37:05,250 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 08:37:05,250 - CtcTrainer - INFO - New best metric (val_cer) at epoch 55: 0.0669
2025-05-10 08:37:05,254 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 08:37:05,255 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 08:37:05,256 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 08:37:06,129 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 08:37:06,129 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 08:37:06,521 - CtcTrainer - INFO - Starting Epoch 56/100
2025-05-10 09:11:50,401 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 09:18:09,363 - CtcTrainer - INFO - Running end-of-epoch 56 validation...
2025-05-10 09:18:11,077 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 09:18:11,078 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 09:18:11,078 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 09:18:11,078 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 09:18:11,078 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 09:18:11,078 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 09:18:11,078 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 09:18:11,078 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 09:18:11,078 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 09:18:11,078 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 09:18:11,078 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer Hjerter og i Huset, der er der evig'
2025-05-10 09:18:11,079 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 09:18:11,079 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 09:18:11,079 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 09:18:11,079 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 09:18:11,079 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 09:18:11,079 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 09:18:11,079 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 09:18:11,079 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 09:18:11,079 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 09:21:05,828 - training.ctc_validation - INFO - Validation Results: Loss=4.4665, CER=0.0684, WER=0.1850
2025-05-10 09:21:05,828 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 09:21:05,831 - CtcTrainer - INFO - --- Epoch 56/100 Summary ---
2025-05-10 09:21:05,831 - CtcTrainer - INFO - Avg Train Loss: 0.0294
2025-05-10 09:21:05,831 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.466481987681627, 'val_cer': 0.06836388762928894, 'val_wer': 0.18496648579636132}
2025-05-10 09:21:05,831 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0669
2025-05-10 09:21:05,831 - CtcTrainer - INFO - ---------------------
2025-05-10 09:21:05,834 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 09:21:07,504 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 09:21:07,505 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 09:21:07,913 - CtcTrainer - INFO - Starting Epoch 57/100
2025-05-10 10:00:35,983 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 10:01:47,657 - CtcTrainer - INFO - Running end-of-epoch 57 validation...
2025-05-10 10:01:49,449 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 10:01:49,449 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 10:01:49,449 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 10:01:49,449 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:01:49,449 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 10:01:49,449 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:01:49,450 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ike boer. i Hjerter og i Huset, der er der evig'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:01:49,450 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:01:49,450 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 10:01:49,450 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 10:01:49,451 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:04:43,820 - training.ctc_validation - INFO - Validation Results: Loss=4.5462, CER=0.0683, WER=0.1858
2025-05-10 10:04:43,820 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 10:04:43,823 - CtcTrainer - INFO - --- Epoch 57/100 Summary ---
2025-05-10 10:04:43,823 - CtcTrainer - INFO - Avg Train Loss: 0.0286
2025-05-10 10:04:43,823 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.546212485287796, 'val_cer': 0.06834229448727085, 'val_wer': 0.18578572188530695}
2025-05-10 10:04:43,823 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0669
2025-05-10 10:04:43,823 - CtcTrainer - INFO - ---------------------
2025-05-10 10:04:43,825 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 10:04:45,492 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 10:04:45,492 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-10 10:04:45,836 - CtcTrainer - INFO - Starting Epoch 58/100
2025-05-10 10:37:40,492 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 10:44:45,642 - CtcTrainer - INFO - Running end-of-epoch 58 validation...
2025-05-10 10:44:47,169 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 10:44:47,170 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 10:44:47,170 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 10:44:47,170 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:44:47,170 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 10:44:47,171 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 10:44:47,171 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 10:44:47,171 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:44:47,171 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 10:44:47,171 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 10:44:47,171 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer  Hjerter og i Huset, der er der evig'
2025-05-10 10:44:47,171 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:44:47,171 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 10:44:47,171 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 10:44:47,171 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 10:44:47,171 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:44:47,172 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 10:44:47,172 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 10:44:47,172 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 10:44:47,172 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 10:47:41,639 - training.ctc_validation - INFO - Validation Results: Loss=4.4143, CER=0.0663, WER=0.1812
2025-05-10 10:47:41,639 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 10:47:41,641 - CtcTrainer - INFO - --- Epoch 58/100 Summary ---
2025-05-10 10:47:41,641 - CtcTrainer - INFO - Avg Train Loss: 0.0256
2025-05-10 10:47:41,641 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.414289966064448, 'val_cer': 0.06628134904354377, 'val_wer': 0.18115756995425045}
2025-05-10 10:47:41,641 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0669
2025-05-10 10:47:41,641 - CtcTrainer - INFO - ---------------------
2025-05-10 10:47:41,643 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 10:47:43,380 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 10:47:43,380 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 10:47:45,107 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 10:47:45,108 - CtcTrainer - INFO - New best metric (val_cer) at epoch 58: 0.0663
2025-05-10 10:47:45,111 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 10:47:45,112 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 10:47:45,113 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 10:47:45,841 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 10:47:45,841 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 10:47:46,162 - CtcTrainer - INFO - Starting Epoch 59/100
2025-05-10 11:20:38,952 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 11:27:42,808 - CtcTrainer - INFO - Running end-of-epoch 59 validation...
2025-05-10 11:27:44,640 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer. i Hjerter og i HHuset, der er der evig'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 11:27:44,641 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 11:27:44,641 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 11:27:44,642 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 11:27:44,642 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 11:30:39,140 - training.ctc_validation - INFO - Validation Results: Loss=4.4569, CER=0.0658, WER=0.1799
2025-05-10 11:30:39,140 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 11:30:39,142 - CtcTrainer - INFO - --- Epoch 59/100 Summary ---
2025-05-10 11:30:39,143 - CtcTrainer - INFO - Avg Train Loss: 0.0242
2025-05-10 11:30:39,143 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.4568764871546955, 'val_cer': 0.06580150144314166, 'val_wer': 0.17985955952760932}
2025-05-10 11:30:39,143 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0663
2025-05-10 11:30:39,143 - CtcTrainer - INFO - ---------------------
2025-05-10 11:30:39,145 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 11:30:40,800 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 11:30:40,800 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 11:30:42,637 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 11:30:42,638 - CtcTrainer - INFO - New best metric (val_cer) at epoch 59: 0.0658
2025-05-10 11:30:42,642 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 11:30:42,642 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 11:30:42,655 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 11:30:43,606 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 11:30:43,606 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 11:30:43,935 - CtcTrainer - INFO - Starting Epoch 60/100
2025-05-10 11:53:22,813 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 12:10:42,368 - CtcTrainer - INFO - Running end-of-epoch 60 validation...
2025-05-10 12:10:43,965 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 12:10:43,966 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 12:10:43,966 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 12:10:43,966 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:10:43,966 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 12:10:43,966 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 12:10:43,967 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 12:10:43,967 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:10:43,967 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 12:10:43,967 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 12:10:43,967 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 12:10:43,967 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:10:43,967 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 12:10:43,967 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 12:10:43,967 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 12:10:43,967 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:10:43,967 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 12:10:43,968 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 12:10:43,968 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 12:10:43,968 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:15:33,733 - training.ctc_validation - INFO - Validation Results: Loss=4.3829, CER=0.0644, WER=0.1757
2025-05-10 12:15:33,734 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 12:15:33,738 - CtcTrainer - INFO - --- Epoch 60/100 Summary ---
2025-05-10 12:15:33,738 - CtcTrainer - INFO - Avg Train Loss: 0.0220
2025-05-10 12:15:33,738 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.3828659434340915, 'val_cer': 0.06435476092792929, 'val_wer': 0.17568890307479518}
2025-05-10 12:15:33,738 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0658
2025-05-10 12:15:33,738 - CtcTrainer - INFO - ---------------------
2025-05-10 12:15:33,743 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 12:15:35,262 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 12:15:35,262 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 12:15:37,042 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 12:15:37,042 - CtcTrainer - INFO - New best metric (val_cer) at epoch 60: 0.0644
2025-05-10 12:15:37,046 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 12:15:37,046 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 12:15:37,047 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 12:15:37,821 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 12:15:37,821 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 12:15:38,331 - CtcTrainer - INFO - Starting Epoch 61/100
2025-05-10 12:35:39,436 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 12:56:23,439 - CtcTrainer - INFO - Running end-of-epoch 61 validation...
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Prediction  : 'hvor Bud ikke boer i Hjerter og e Huset, der er der eveg'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:56:25,376 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 12:56:25,376 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 12:56:25,377 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 12:56:25,377 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 12:59:20,855 - training.ctc_validation - INFO - Validation Results: Loss=4.6337, CER=0.0677, WER=0.1854
2025-05-10 12:59:20,856 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 12:59:20,858 - CtcTrainer - INFO - --- Epoch 61/100 Summary ---
2025-05-10 12:59:20,858 - CtcTrainer - INFO - Avg Train Loss: 0.0267
2025-05-10 12:59:20,858 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.63366985507671, 'val_cer': 0.0676513139426918, 'val_wer': 0.18538142355569742}
2025-05-10 12:59:20,859 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0644
2025-05-10 12:59:20,859 - CtcTrainer - INFO - ---------------------
2025-05-10 12:59:20,860 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 12:59:22,619 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 12:59:22,619 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 12:59:23,031 - CtcTrainer - INFO - Starting Epoch 62/100
2025-05-10 13:15:53,358 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 13:39:39,872 - CtcTrainer - INFO - Running end-of-epoch 62 validation...
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer. i. Hjerter og i Huset, der er der evig'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 13:39:41,791 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 13:42:36,861 - training.ctc_validation - INFO - Validation Results: Loss=4.4301, CER=0.0643, WER=0.1764
2025-05-10 13:42:36,862 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 13:42:36,864 - CtcTrainer - INFO - --- Epoch 62/100 Summary ---
2025-05-10 13:42:36,864 - CtcTrainer - INFO - Avg Train Loss: 0.0279
2025-05-10 13:42:36,864 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.43007349836812, 'val_cer': 0.06434036549991723, 'val_wer': 0.17644430258538144}
2025-05-10 13:42:36,864 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0644
2025-05-10 13:42:36,864 - CtcTrainer - INFO - ---------------------
2025-05-10 13:42:36,867 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 13:42:38,588 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 13:42:38,589 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 13:42:40,320 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 13:42:40,320 - CtcTrainer - INFO - New best metric (val_cer) at epoch 62: 0.0643
2025-05-10 13:42:40,324 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 13:42:40,325 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 13:42:40,327 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 13:42:41,198 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 13:42:41,199 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 13:42:41,565 - CtcTrainer - INFO - Starting Epoch 63/100
2025-05-10 13:54:13,797 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 14:23:01,120 - CtcTrainer - INFO - Running end-of-epoch 63 validation...
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og ig Husset, der er der evig'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 14:23:02,763 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 14:25:57,424 - training.ctc_validation - INFO - Validation Results: Loss=4.4088, CER=0.0628, WER=0.1714
2025-05-10 14:25:57,425 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 14:25:57,427 - CtcTrainer - INFO - --- Epoch 63/100 Summary ---
2025-05-10 14:25:57,427 - CtcTrainer - INFO - Avg Train Loss: 0.0229
2025-05-10 14:25:57,427 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.40882839908175, 'val_cer': 0.06278326003661237, 'val_wer': 0.1713799340355357}
2025-05-10 14:25:57,427 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0643
2025-05-10 14:25:57,427 - CtcTrainer - INFO - ---------------------
2025-05-10 14:25:57,429 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 14:25:59,320 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 14:25:59,320 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 14:26:00,983 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 14:26:00,984 - CtcTrainer - INFO - New best metric (val_cer) at epoch 63: 0.0628
2025-05-10 14:26:00,988 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 14:26:00,989 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 14:26:00,991 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 14:26:02,005 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 14:26:02,006 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 14:26:02,524 - CtcTrainer - INFO - Starting Epoch 64/100
2025-05-10 14:35:11,297 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 15:06:36,873 - CtcTrainer - INFO - Running end-of-epoch 64 validation...
2025-05-10 15:06:38,758 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 15:06:38,759 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 15:06:38,759 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 15:06:38,759 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:06:38,759 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 15:06:38,759 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 15:06:38,759 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 15:06:38,759 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:06:38,759 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 15:06:38,759 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 15:06:38,759 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 15:06:38,759 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:06:38,760 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 15:06:38,760 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 15:06:38,760 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 15:06:38,760 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:06:38,760 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 15:06:38,760 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 15:06:38,760 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 15:06:38,760 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:09:33,628 - training.ctc_validation - INFO - Validation Results: Loss=4.4967, CER=0.0631, WER=0.1726
2025-05-10 15:09:33,629 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 15:09:33,631 - CtcTrainer - INFO - --- Epoch 64/100 Summary ---
2025-05-10 15:09:33,631 - CtcTrainer - INFO - Avg Train Loss: 0.0206
2025-05-10 15:09:33,631 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.496726079951647, 'val_cer': 0.06311915335689385, 'val_wer': 0.17257155016491116}
2025-05-10 15:09:33,631 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0628
2025-05-10 15:09:33,631 - CtcTrainer - INFO - ---------------------
2025-05-10 15:09:33,633 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 15:09:35,320 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 15:09:35,320 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 15:09:35,702 - CtcTrainer - INFO - Starting Epoch 65/100
2025-05-10 15:19:29,987 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 15:50:19,137 - CtcTrainer - INFO - Running end-of-epoch 65 validation...
2025-05-10 15:50:21,088 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 15:50:21,088 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 15:50:21,088 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 15:50:21,088 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:50:21,088 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 15:50:21,088 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 15:50:21,088 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 15:50:21,088 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:50:21,088 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 15:50:21,088 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 15:50:21,089 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke beer i Hjerter og i Huset, der er der evig'
2025-05-10 15:50:21,089 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:50:21,089 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 15:50:21,089 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 15:50:21,089 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 15:50:21,089 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:50:21,089 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 15:50:21,089 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 15:50:21,089 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 15:50:21,089 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 15:53:18,171 - training.ctc_validation - INFO - Validation Results: Loss=4.5798, CER=0.0635, WER=0.1739
2025-05-10 15:53:18,171 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 15:53:18,173 - CtcTrainer - INFO - --- Epoch 65/100 Summary ---
2025-05-10 15:53:18,173 - CtcTrainer - INFO - Avg Train Loss: 0.0198
2025-05-10 15:53:18,173 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.579758269704236, 'val_cer': 0.06347663981919342, 'val_wer': 0.17390147888073199}
2025-05-10 15:53:18,173 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0628
2025-05-10 15:53:18,173 - CtcTrainer - INFO - ---------------------
2025-05-10 15:53:18,175 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 15:53:19,818 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 15:53:19,818 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-10 15:53:20,153 - CtcTrainer - INFO - Starting Epoch 66/100
2025-05-10 16:26:59,822 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 16:33:54,191 - CtcTrainer - INFO - Running end-of-epoch 66 validation...
2025-05-10 16:33:55,843 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke ber i Hjerter og i Huset, der er der evyg'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 16:33:55,844 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 16:33:55,844 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 16:33:55,845 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 16:33:55,845 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 16:36:50,179 - training.ctc_validation - INFO - Validation Results: Loss=4.5737, CER=0.0630, WER=0.1728
2025-05-10 16:36:50,179 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 16:36:50,181 - CtcTrainer - INFO - --- Epoch 66/100 Summary ---
2025-05-10 16:36:50,181 - CtcTrainer - INFO - Avg Train Loss: 0.0194
2025-05-10 16:36:50,181 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.573700423540903, 'val_cer': 0.06298719526678327, 'val_wer': 0.1728481753378019}
2025-05-10 16:36:50,181 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0628
2025-05-10 16:36:50,181 - CtcTrainer - INFO - ---------------------
2025-05-10 16:36:50,183 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 16:36:51,857 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 16:36:51,858 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=10
2025-05-10 16:36:52,245 - CtcTrainer - INFO - Starting Epoch 67/100
2025-05-10 16:43:11,258 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 17:17:45,203 - CtcTrainer - INFO - Running end-of-epoch 67 validation...
2025-05-10 17:17:47,126 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 17:17:47,126 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 17:17:47,126 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 17:17:47,126 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 17:17:47,127 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 17:20:42,330 - training.ctc_validation - INFO - Validation Results: Loss=4.6716, CER=0.0626, WER=0.1715
2025-05-10 17:20:42,330 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 17:20:42,333 - CtcTrainer - INFO - --- Epoch 67/100 Summary ---
2025-05-10 17:20:42,333 - CtcTrainer - INFO - Avg Train Loss: 0.0187
2025-05-10 17:20:42,333 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.6715518257149835, 'val_cer': 0.06262730956648169, 'val_wer': 0.17148632833280136}
2025-05-10 17:20:42,333 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0628
2025-05-10 17:20:42,333 - CtcTrainer - INFO - ---------------------
2025-05-10 17:20:42,336 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 17:20:44,048 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 17:20:44,048 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 17:20:45,839 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 17:20:45,839 - CtcTrainer - INFO - New best metric (val_cer) at epoch 67: 0.0626
2025-05-10 17:20:45,844 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 17:20:45,845 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 17:20:45,848 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 17:20:46,652 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 17:20:46,652 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 17:20:47,014 - CtcTrainer - INFO - Starting Epoch 68/100
2025-05-10 17:41:29,587 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 18:01:36,983 - CtcTrainer - INFO - Running end-of-epoch 68 validation...
2025-05-10 18:01:39,057 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 18:01:39,058 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 18:01:39,058 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 18:01:39,058 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:01:39,058 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huyset, der er der evig'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 18:01:39,059 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:04:33,718 - training.ctc_validation - INFO - Validation Results: Loss=4.5765, CER=0.0613, WER=0.1686
2025-05-10 18:04:33,719 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 18:04:33,721 - CtcTrainer - INFO - --- Epoch 68/100 Summary ---
2025-05-10 18:04:33,721 - CtcTrainer - INFO - Avg Train Loss: 0.0163
2025-05-10 18:04:33,721 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.576453951864306, 'val_cer': 0.061293333237363815, 'val_wer': 0.16856048515799554}
2025-05-10 18:04:33,721 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0626
2025-05-10 18:04:33,721 - CtcTrainer - INFO - ---------------------
2025-05-10 18:04:33,724 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 18:04:35,721 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 18:04:35,721 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 18:04:37,713 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 18:04:37,713 - CtcTrainer - INFO - New best metric (val_cer) at epoch 68: 0.0613
2025-05-10 18:04:37,717 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 18:04:37,718 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 18:04:37,721 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 18:04:38,498 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 18:04:38,499 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 18:04:39,094 - CtcTrainer - INFO - Starting Epoch 69/100
2025-05-10 18:38:19,807 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 18:45:32,308 - CtcTrainer - INFO - Running end-of-epoch 69 validation...
2025-05-10 18:45:34,072 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 18:45:34,073 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:45:34,073 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 18:45:34,073 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:45:34,073 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 18:45:34,073 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:45:34,073 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 18:45:34,073 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 18:45:34,074 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 18:45:34,074 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:45:34,074 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 18:45:34,074 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 18:45:34,074 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 18:45:34,074 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 18:48:28,331 - training.ctc_validation - INFO - Validation Results: Loss=4.6344, CER=0.0604, WER=0.1664
2025-05-10 18:48:28,331 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 18:48:28,334 - CtcTrainer - INFO - --- Epoch 69/100 Summary ---
2025-05-10 18:48:28,334 - CtcTrainer - INFO - Avg Train Loss: 0.0170
2025-05-10 18:48:28,335 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.634416272395085, 'val_cer': 0.060446402222654086, 'val_wer': 0.16639004149377593}
2025-05-10 18:48:28,335 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0613
2025-05-10 18:48:28,335 - CtcTrainer - INFO - ---------------------
2025-05-10 18:48:28,338 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 18:48:29,867 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 18:48:29,867 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 18:48:31,759 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 18:48:31,759 - CtcTrainer - INFO - New best metric (val_cer) at epoch 69: 0.0604
2025-05-10 18:48:31,764 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 18:48:31,765 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 18:48:31,767 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 18:48:32,501 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 18:48:32,501 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 18:48:32,872 - CtcTrainer - INFO - Starting Epoch 70/100
2025-05-10 18:58:01,191 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 19:29:18,611 - CtcTrainer - INFO - Running end-of-epoch 70 validation...
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer iHjerter og i Huset, der er der evyg'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 19:29:20,363 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 19:29:20,363 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 19:29:20,364 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 19:29:20,364 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 19:32:14,953 - training.ctc_validation - INFO - Validation Results: Loss=4.5731, CER=0.0615, WER=0.1681
2025-05-10 19:32:14,953 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 19:32:14,955 - CtcTrainer - INFO - --- Epoch 70/100 Summary ---
2025-05-10 19:32:14,955 - CtcTrainer - INFO - Avg Train Loss: 0.0175
2025-05-10 19:32:14,955 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.573119317893525, 'val_cer': 0.061468477611510586, 'val_wer': 0.16807107139057348}
2025-05-10 19:32:14,955 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0604
2025-05-10 19:32:14,955 - CtcTrainer - INFO - ---------------------
2025-05-10 19:32:14,958 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 19:32:16,601 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 19:32:16,602 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 19:32:16,938 - CtcTrainer - INFO - Starting Epoch 71/100
2025-05-10 20:05:46,224 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 20:12:54,629 - CtcTrainer - INFO - Running end-of-epoch 71 validation...
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Heslet, der er der evig'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-10 20:12:56,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:15:51,451 - training.ctc_validation - INFO - Validation Results: Loss=4.6086, CER=0.0597, WER=0.1639
2025-05-10 20:15:51,453 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 20:15:51,455 - CtcTrainer - INFO - --- Epoch 71/100 Summary ---
2025-05-10 20:15:51,455 - CtcTrainer - INFO - Avg Train Loss: 0.0153
2025-05-10 20:15:51,456 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.608565871923411, 'val_cer': 0.059705037680032824, 'val_wer': 0.16388977550803277}
2025-05-10 20:15:51,456 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0604
2025-05-10 20:15:51,456 - CtcTrainer - INFO - ---------------------
2025-05-10 20:15:51,461 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 20:15:53,131 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 20:15:53,132 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 20:15:55,044 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 20:15:55,045 - CtcTrainer - INFO - New best metric (val_cer) at epoch 71: 0.0597
2025-05-10 20:15:55,048 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 20:15:55,050 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 20:15:55,053 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 20:15:55,757 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 20:15:55,757 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 20:15:56,450 - CtcTrainer - INFO - Starting Epoch 72/100
2025-05-10 20:55:20,433 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 20:56:21,324 - CtcTrainer - INFO - Running end-of-epoch 72 validation...
2025-05-10 20:56:23,215 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 20:56:23,215 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 20:56:23,215 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 20:56:23,215 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:56:23,215 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 20:56:23,216 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 20:56:23,216 - training.ctc_validation - INFO -   Prediction  : 'ruột'
2025-05-10 20:56:23,216 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:56:23,216 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 20:56:23,216 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 20:56:23,216 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 20:56:23,216 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:56:23,217 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 20:56:23,217 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 20:56:23,217 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 20:56:23,217 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:56:23,217 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 20:56:23,217 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 20:56:23,217 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 20:56:23,218 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 20:59:17,732 - training.ctc_validation - INFO - Validation Results: Loss=4.5817, CER=0.0600, WER=0.1641
2025-05-10 20:59:17,733 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 20:59:17,735 - CtcTrainer - INFO - --- Epoch 72/100 Summary ---
2025-05-10 20:59:17,735 - CtcTrainer - INFO - Avg Train Loss: 0.0139
2025-05-10 20:59:17,735 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.581700678877649, 'val_cer': 0.060028934810304246, 'val_wer': 0.1641025641025641}
2025-05-10 20:59:17,735 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0597
2025-05-10 20:59:17,735 - CtcTrainer - INFO - ---------------------
2025-05-10 20:59:17,738 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 20:59:19,357 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 20:59:19,357 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 20:59:19,714 - CtcTrainer - INFO - Starting Epoch 73/100
2025-05-10 21:15:18,742 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 21:39:40,273 - CtcTrainer - INFO - Running end-of-epoch 73 validation...
2025-05-10 21:39:42,150 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 21:39:42,150 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 21:39:42,150 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Herter og i Huset, der er der evig'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 21:39:42,151 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 21:42:37,032 - training.ctc_validation - INFO - Validation Results: Loss=4.8523, CER=0.0624, WER=0.1707
2025-05-10 21:42:37,032 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 21:42:37,034 - CtcTrainer - INFO - --- Epoch 73/100 Summary ---
2025-05-10 21:42:37,034 - CtcTrainer - INFO - Avg Train Loss: 0.0137
2025-05-10 21:42:37,034 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.852338786995265, 'val_cer': 0.062358594910256505, 'val_wer': 0.17066709224385573}
2025-05-10 21:42:37,035 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0597
2025-05-10 21:42:37,035 - CtcTrainer - INFO - ---------------------
2025-05-10 21:42:37,037 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 21:42:38,574 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 21:42:38,575 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-10 21:42:39,085 - CtcTrainer - INFO - Starting Epoch 74/100
2025-05-10 21:49:14,744 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 22:22:55,400 - CtcTrainer - INFO - Running end-of-epoch 74 validation...
2025-05-10 22:22:57,214 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evyg'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO -   Prediction  : 'đh'
2025-05-10 22:22:57,215 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 22:25:51,034 - training.ctc_validation - INFO - Validation Results: Loss=4.7549, CER=0.0591, WER=0.1619
2025-05-10 22:25:51,034 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 22:25:51,036 - CtcTrainer - INFO - --- Epoch 74/100 Summary ---
2025-05-10 22:25:51,036 - CtcTrainer - INFO - Avg Train Loss: 0.0126
2025-05-10 22:25:51,036 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.754905923069654, 'val_cer': 0.059071638847502037, 'val_wer': 0.16194275986807108}
2025-05-10 22:25:51,036 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0597
2025-05-10 22:25:51,036 - CtcTrainer - INFO - ---------------------
2025-05-10 22:25:51,039 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 22:25:52,581 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 22:25:52,582 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 22:25:54,434 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 22:25:54,434 - CtcTrainer - INFO - New best metric (val_cer) at epoch 74: 0.0591
2025-05-10 22:25:54,438 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 22:25:54,441 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 22:25:54,444 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 22:25:55,180 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 22:25:55,180 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 22:25:55,811 - CtcTrainer - INFO - Starting Epoch 75/100
2025-05-10 22:40:09,952 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 23:05:59,030 - CtcTrainer - INFO - Running end-of-epoch 75 validation...
2025-05-10 23:06:00,768 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evyg'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 23:06:00,769 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:08:54,819 - training.ctc_validation - INFO - Validation Results: Loss=4.7300, CER=0.0585, WER=0.1616
2025-05-10 23:08:54,819 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 23:08:54,821 - CtcTrainer - INFO - --- Epoch 75/100 Summary ---
2025-05-10 23:08:54,821 - CtcTrainer - INFO - Avg Train Loss: 0.0124
2025-05-10 23:08:54,821 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.729960865904409, 'val_cer': 0.058486224775011454, 'val_wer': 0.16162357697627408}
2025-05-10 23:08:54,821 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0591
2025-05-10 23:08:54,821 - CtcTrainer - INFO - ---------------------
2025-05-10 23:08:54,824 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 23:08:56,356 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 23:08:56,356 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-10 23:08:57,881 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-10 23:08:57,882 - CtcTrainer - INFO - New best metric (val_cer) at epoch 75: 0.0585
2025-05-10 23:08:57,885 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 23:08:57,885 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 23:08:57,887 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-10 23:08:58,636 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-10 23:08:58,637 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-10 23:08:58,968 - CtcTrainer - INFO - Starting Epoch 76/100
2025-05-10 23:29:26,573 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-10 23:49:00,077 - CtcTrainer - INFO - Running end-of-epoch 76 validation...
2025-05-10 23:49:01,954 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-10 23:49:01,954 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-10 23:49:01,954 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-10 23:49:01,954 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:49:01,954 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-10 23:49:01,954 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-10 23:49:01,954 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-10 23:49:01,954 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:49:01,955 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-10 23:49:01,955 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 23:49:01,955 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-10 23:49:01,955 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:49:01,955 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-10 23:49:01,955 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-10 23:49:01,955 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-10 23:49:01,955 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:49:01,955 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-10 23:49:01,955 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-10 23:49:01,955 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-10 23:49:01,955 - training.ctc_validation - INFO - ---------------------------------
2025-05-10 23:51:55,932 - training.ctc_validation - INFO - Validation Results: Loss=4.8945, CER=0.0601, WER=0.1652
2025-05-10 23:51:55,933 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-10 23:51:55,935 - CtcTrainer - INFO - --- Epoch 76/100 Summary ---
2025-05-10 23:51:55,935 - CtcTrainer - INFO - Avg Train Loss: 0.0128
2025-05-10 23:51:55,935 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.894493191380471, 'val_cer': 0.06008171804634848, 'val_wer': 0.16524098308330673}
2025-05-10 23:51:55,935 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0585
2025-05-10 23:51:55,935 - CtcTrainer - INFO - ---------------------
2025-05-10 23:51:55,938 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-10 23:51:57,626 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-10 23:51:57,627 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-10 23:51:57,949 - CtcTrainer - INFO - Starting Epoch 77/100
2025-05-10 23:52:49,877 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 00:31:58,879 - CtcTrainer - INFO - Running end-of-epoch 77 validation...
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer HHjerter og i Huset, der er der evig'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 00:32:00,623 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 00:32:00,623 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 00:32:00,624 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 00:32:00,624 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 00:32:00,624 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 00:32:00,624 - training.ctc_validation - INFO -   Prediction  : 'đine'
2025-05-11 00:32:00,624 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 00:34:54,648 - training.ctc_validation - INFO - Validation Results: Loss=4.9093, CER=0.0605, WER=0.1660
2025-05-11 00:34:54,649 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 00:34:54,652 - CtcTrainer - INFO - --- Epoch 77/100 Summary ---
2025-05-11 00:34:54,652 - CtcTrainer - INFO - Avg Train Loss: 0.0122
2025-05-11 00:34:54,652 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.909287988787301, 'val_cer': 0.0604727938406762, 'val_wer': 0.16596446430471326}
2025-05-11 00:34:54,652 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0585
2025-05-11 00:34:54,652 - CtcTrainer - INFO - ---------------------
2025-05-11 00:34:54,657 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 00:34:56,280 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 00:34:56,281 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-11 00:34:56,625 - CtcTrainer - INFO - Starting Epoch 78/100
2025-05-11 00:41:35,506 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 01:15:02,386 - CtcTrainer - INFO - Running end-of-epoch 78 validation...
2025-05-11 01:15:03,947 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:15:03,948 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 01:15:03,949 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 01:15:03,949 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-11 01:15:03,949 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:17:58,467 - training.ctc_validation - INFO - Validation Results: Loss=4.9594, CER=0.0595, WER=0.1635
2025-05-11 01:17:58,468 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 01:17:58,470 - CtcTrainer - INFO - --- Epoch 78/100 Summary ---
2025-05-11 01:17:58,470 - CtcTrainer - INFO - Avg Train Loss: 0.0126
2025-05-11 01:17:58,470 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.9594001194539326, 'val_cer': 0.05954428873389812, 'val_wer': 0.1634641983189701}
2025-05-11 01:17:58,470 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0585
2025-05-11 01:17:58,470 - CtcTrainer - INFO - ---------------------
2025-05-11 01:17:58,472 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 01:18:00,769 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 01:18:00,770 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=10
2025-05-11 01:18:01,335 - CtcTrainer - INFO - Starting Epoch 79/100
2025-05-11 01:26:39,443 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 01:58:01,128 - CtcTrainer - INFO - Running end-of-epoch 79 validation...
2025-05-11 01:58:03,008 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 01:58:03,008 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 01:58:03,008 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 01:58:03,008 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:58:03,008 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 01:58:03,008 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 01:58:03,008 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 01:58:03,009 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 01:58:03,009 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 01:58:03,009 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-11 01:58:03,009 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 02:00:56,624 - training.ctc_validation - INFO - Validation Results: Loss=4.9867, CER=0.0606, WER=0.1658
2025-05-11 02:00:56,624 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 02:00:56,626 - CtcTrainer - INFO - --- Epoch 79/100 Summary ---
2025-05-11 02:00:56,627 - CtcTrainer - INFO - Avg Train Loss: 0.0114
2025-05-11 02:00:56,627 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.986731375196877, 'val_cer': 0.06064074050081694, 'val_wer': 0.1658261517182679}
2025-05-11 02:00:56,627 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0585
2025-05-11 02:00:56,627 - CtcTrainer - INFO - ---------------------
2025-05-11 02:00:56,629 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 02:00:58,644 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 02:00:58,644 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=4, patience=10
2025-05-11 02:00:59,341 - CtcTrainer - INFO - Starting Epoch 80/100
2025-05-11 02:10:18,460 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 02:40:49,748 - CtcTrainer - INFO - Running end-of-epoch 80 validation...
2025-05-11 02:40:51,716 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 02:40:51,716 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 02:40:51,716 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-11 02:40:51,717 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 02:43:45,424 - training.ctc_validation - INFO - Validation Results: Loss=5.0898, CER=0.0592, WER=0.1631
2025-05-11 02:43:45,424 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 02:43:45,426 - CtcTrainer - INFO - --- Epoch 80/100 Summary ---
2025-05-11 02:43:45,426 - CtcTrainer - INFO - Avg Train Loss: 0.0101
2025-05-11 02:43:45,426 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.089845688344963, 'val_cer': 0.059232387793636744, 'val_wer': 0.1630811788488137}
2025-05-11 02:43:45,426 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0585
2025-05-11 02:43:45,426 - CtcTrainer - INFO - ---------------------
2025-05-11 02:43:45,428 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 02:43:47,111 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 02:43:47,111 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=5, patience=10
2025-05-11 02:43:47,456 - CtcTrainer - INFO - Starting Epoch 81/100
2025-05-11 03:12:59,302 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 03:23:25,459 - CtcTrainer - INFO - Running end-of-epoch 81 validation...
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Hiset, der er der evig'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 03:23:27,302 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 03:23:27,303 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 03:23:27,303 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 03:23:27,303 - training.ctc_validation - INFO -   Prediction  : 'đine'
2025-05-11 03:23:27,303 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 03:26:21,625 - training.ctc_validation - INFO - Validation Results: Loss=4.9067, CER=0.0576, WER=0.1588
2025-05-11 03:26:21,625 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 03:26:21,627 - CtcTrainer - INFO - --- Epoch 81/100 Summary ---
2025-05-11 03:26:21,627 - CtcTrainer - INFO - Avg Train Loss: 0.0102
2025-05-11 03:26:21,627 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.906677045795369, 'val_cer': 0.05755532043023136, 'val_wer': 0.1588360463879136}
2025-05-11 03:26:21,627 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0585
2025-05-11 03:26:21,627 - CtcTrainer - INFO - ---------------------
2025-05-11 03:26:21,630 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 03:26:23,360 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 03:26:23,361 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-11 03:26:24,995 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-11 03:26:24,995 - CtcTrainer - INFO - New best metric (val_cer) at epoch 81: 0.0576
2025-05-11 03:26:24,997 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 03:26:24,998 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 03:26:24,999 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 03:26:25,830 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 03:26:25,830 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-11 03:26:26,222 - CtcTrainer - INFO - Starting Epoch 82/100
2025-05-11 03:50:20,870 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 04:06:18,271 - CtcTrainer - INFO - Running end-of-epoch 82 validation...
2025-05-11 04:06:19,739 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 04:06:19,739 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 04:06:19,739 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 04:06:19,739 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Heset, der er der evig'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-11 04:06:19,740 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:09:15,778 - training.ctc_validation - INFO - Validation Results: Loss=4.9487, CER=0.0576, WER=0.1582
2025-05-11 04:09:15,779 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 04:09:15,782 - CtcTrainer - INFO - --- Epoch 82/100 Summary ---
2025-05-11 04:09:15,783 - CtcTrainer - INFO - Avg Train Loss: 0.0091
2025-05-11 04:09:15,783 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.948708666956213, 'val_cer': 0.05756971585824342, 'val_wer': 0.15820832003404617}
2025-05-11 04:09:15,783 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0576
2025-05-11 04:09:15,783 - CtcTrainer - INFO - ---------------------
2025-05-11 04:09:15,787 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 04:09:17,725 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 04:09:17,725 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-11 04:09:18,106 - CtcTrainer - INFO - Starting Epoch 83/100
2025-05-11 04:10:52,342 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 04:49:21,297 - CtcTrainer - INFO - Running end-of-epoch 83 validation...
2025-05-11 04:49:22,973 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Heset, der er der evig'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 04:49:22,974 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:49:22,975 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 04:49:22,975 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 04:49:22,975 - training.ctc_validation - INFO -   Prediction  : 'đine'
2025-05-11 04:49:22,975 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 04:52:19,148 - training.ctc_validation - INFO - Validation Results: Loss=5.0151, CER=0.0566, WER=0.1565
2025-05-11 04:52:19,149 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 04:52:19,152 - CtcTrainer - INFO - --- Epoch 83/100 Summary ---
2025-05-11 04:52:19,152 - CtcTrainer - INFO - Avg Train Loss: 0.0079
2025-05-11 04:52:19,152 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.0150676196958965, 'val_cer': 0.05655483818339296, 'val_wer': 0.15648473241834238}
2025-05-11 04:52:19,152 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0576
2025-05-11 04:52:19,152 - CtcTrainer - INFO - ---------------------
2025-05-11 04:52:19,154 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 04:52:20,948 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 04:52:20,948 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-11 04:52:22,691 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-11 04:52:22,692 - CtcTrainer - INFO - New best metric (val_cer) at epoch 83: 0.0566
2025-05-11 04:52:22,696 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 04:52:22,697 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 04:52:22,699 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 04:52:23,481 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 04:52:23,482 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-11 04:52:23,870 - CtcTrainer - INFO - Starting Epoch 84/100
2025-05-11 05:22:18,826 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 05:32:26,969 - CtcTrainer - INFO - Running end-of-epoch 84 validation...
2025-05-11 05:32:28,678 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 05:32:28,678 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 05:32:28,678 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 05:32:28,678 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 05:32:28,678 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 05:32:28,678 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 05:32:28,678 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 05:32:28,678 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 05:32:28,678 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 05:32:28,679 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 05:32:28,679 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huyset, der er der evig'
2025-05-11 05:32:28,679 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 05:32:28,679 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 05:32:28,679 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 05:32:28,680 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 05:32:28,680 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 05:32:28,680 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 05:32:28,680 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 05:32:28,680 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 05:32:28,680 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 05:35:22,826 - training.ctc_validation - INFO - Validation Results: Loss=4.9428, CER=0.0561, WER=0.1548
2025-05-11 05:35:22,827 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 05:35:22,829 - CtcTrainer - INFO - --- Epoch 84/100 Summary ---
2025-05-11 05:35:22,829 - CtcTrainer - INFO - Avg Train Loss: 0.0067
2025-05-11 05:35:22,829 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 4.94284369834699, 'val_cer': 0.056094184487006926, 'val_wer': 0.15484626024045112}
2025-05-11 05:35:22,829 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0566
2025-05-11 05:35:22,829 - CtcTrainer - INFO - ---------------------
2025-05-11 05:35:22,833 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 05:35:24,739 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 05:35:24,740 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-11 05:35:26,413 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-11 05:35:26,413 - CtcTrainer - INFO - New best metric (val_cer) at epoch 84: 0.0561
2025-05-11 05:35:26,415 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 05:35:26,416 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 05:35:26,417 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 05:35:27,216 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 05:35:27,216 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-11 05:35:27,615 - CtcTrainer - INFO - Starting Epoch 85/100
2025-05-11 05:48:10,346 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 06:15:34,329 - CtcTrainer - INFO - Running end-of-epoch 85 validation...
2025-05-11 06:15:35,859 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 06:15:35,859 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 06:15:35,859 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 06:15:35,859 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:15:35,859 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 06:15:35,859 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 06:15:35,859 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 06:15:35,860 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 06:15:35,860 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 06:15:35,860 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 06:15:35,860 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:18:30,317 - training.ctc_validation - INFO - Validation Results: Loss=5.1142, CER=0.0569, WER=0.1567
2025-05-11 06:18:30,317 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 06:18:30,319 - CtcTrainer - INFO - --- Epoch 85/100 Summary ---
2025-05-11 06:18:30,319 - CtcTrainer - INFO - Avg Train Loss: 0.0067
2025-05-11 06:18:30,319 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.11424848906004, 'val_cer': 0.05691712312169655, 'val_wer': 0.15667624215342058}
2025-05-11 06:18:30,319 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0561
2025-05-11 06:18:30,319 - CtcTrainer - INFO - ---------------------
2025-05-11 06:18:30,322 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 06:18:32,039 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 06:18:32,040 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-11 06:18:32,418 - CtcTrainer - INFO - Starting Epoch 86/100
2025-05-11 06:38:45,100 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 06:59:34,607 - CtcTrainer - INFO - Running end-of-epoch 86 validation...
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 06:59:36,411 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 06:59:36,412 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 06:59:36,412 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 06:59:36,412 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 07:02:39,436 - training.ctc_validation - INFO - Validation Results: Loss=5.0590, CER=0.0568, WER=0.1563
2025-05-11 07:02:39,436 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 07:02:39,439 - CtcTrainer - INFO - --- Epoch 86/100 Summary ---
2025-05-11 07:02:39,439 - CtcTrainer - INFO - Avg Train Loss: 0.0068
2025-05-11 07:02:39,439 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.058982997967555, 'val_cer': 0.056792362745592, 'val_wer': 0.15627194382381104}
2025-05-11 07:02:39,439 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0561
2025-05-11 07:02:39,439 - CtcTrainer - INFO - ---------------------
2025-05-11 07:02:39,442 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 07:02:41,217 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 07:02:41,218 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-11 07:02:41,589 - CtcTrainer - INFO - Starting Epoch 87/100
2025-05-11 07:34:47,772 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 07:42:35,199 - CtcTrainer - INFO - Running end-of-epoch 87 validation...
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 07:42:36,939 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 07:42:36,939 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 07:42:36,940 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 07:42:36,940 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 07:45:31,220 - training.ctc_validation - INFO - Validation Results: Loss=5.1755, CER=0.0570, WER=0.1578
2025-05-11 07:45:31,220 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 07:45:31,222 - CtcTrainer - INFO - --- Epoch 87/100 Summary ---
2025-05-11 07:45:31,223 - CtcTrainer - INFO - Avg Train Loss: 0.0066
2025-05-11 07:45:31,223 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.17549676662229, 'val_cer': 0.057022689593785016, 'val_wer': 0.1577827428449835}
2025-05-11 07:45:31,223 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0561
2025-05-11 07:45:31,223 - CtcTrainer - INFO - ---------------------
2025-05-11 07:45:31,225 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 07:45:32,966 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 07:45:32,966 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=10
2025-05-11 07:45:33,320 - CtcTrainer - INFO - Starting Epoch 88/100
2025-05-11 08:09:03,711 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 08:25:31,470 - CtcTrainer - INFO - Running end-of-epoch 88 validation...
2025-05-11 08:25:33,464 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 08:25:33,465 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 08:25:33,465 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 08:25:33,465 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 08:25:33,465 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 08:25:33,465 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 08:25:33,465 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 08:25:33,465 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 08:25:33,465 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 08:25:33,466 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 08:25:33,466 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 08:25:33,466 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 08:25:33,466 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 08:25:33,466 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 08:25:33,466 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 08:25:33,466 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 08:25:33,466 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 08:25:33,466 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 08:25:33,466 - training.ctc_validation - INFO -   Prediction  : 'đine'
2025-05-11 08:25:33,466 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 08:28:27,445 - training.ctc_validation - INFO - Validation Results: Loss=5.1228, CER=0.0563, WER=0.1552
2025-05-11 08:28:27,445 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 08:28:27,447 - CtcTrainer - INFO - --- Epoch 88/100 Summary ---
2025-05-11 08:28:27,448 - CtcTrainer - INFO - Avg Train Loss: 0.0070
2025-05-11 08:28:27,448 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.122821681373597, 'val_cer': 0.05628852276516978, 'val_wer': 0.15519736142142782}
2025-05-11 08:28:27,448 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0561
2025-05-11 08:28:27,448 - CtcTrainer - INFO - ---------------------
2025-05-11 08:28:27,451 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 08:28:29,487 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 08:28:29,487 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=4, patience=10
2025-05-11 08:28:29,847 - CtcTrainer - INFO - Starting Epoch 89/100
2025-05-11 08:43:22,664 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 09:08:22,864 - CtcTrainer - INFO - Running end-of-epoch 89 validation...
2025-05-11 09:08:24,681 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 09:08:24,681 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 09:08:24,681 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 09:08:24,681 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:08:24,681 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 09:08:24,681 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 09:08:24,681 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 09:08:24,682 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 09:08:24,682 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 09:08:24,682 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO -   Prediction  : 'đinh'
2025-05-11 09:08:24,682 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:11:18,345 - training.ctc_validation - INFO - Validation Results: Loss=5.2185, CER=0.0566, WER=0.1560
2025-05-11 09:11:18,345 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 09:11:18,347 - CtcTrainer - INFO - --- Epoch 89/100 Summary ---
2025-05-11 09:11:18,347 - CtcTrainer - INFO - Avg Train Loss: 0.0062
2025-05-11 09:11:18,347 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.2185131304001, 'val_cer': 0.05663161379945729, 'val_wer': 0.1559953186509203}
2025-05-11 09:11:18,347 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0561
2025-05-11 09:11:18,347 - CtcTrainer - INFO - ---------------------
2025-05-11 09:11:18,349 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 09:11:20,058 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 09:11:20,058 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=5, patience=10
2025-05-11 09:11:20,430 - CtcTrainer - INFO - Starting Epoch 90/100
2025-05-11 09:27:00,911 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 09:51:04,306 - CtcTrainer - INFO - Running end-of-epoch 90 validation...
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO -   Prediction  : 'địng'
2025-05-11 09:51:06,157 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 09:53:59,932 - training.ctc_validation - INFO - Validation Results: Loss=5.1980, CER=0.0559, WER=0.1540
2025-05-11 09:53:59,933 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 09:53:59,935 - CtcTrainer - INFO - --- Epoch 90/100 Summary ---
2025-05-11 09:53:59,935 - CtcTrainer - INFO - Avg Train Loss: 0.0057
2025-05-11 09:53:59,935 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.1979816540599755, 'val_cer': 0.055945431730882275, 'val_wer': 0.15401638472177892}
2025-05-11 09:53:59,935 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0561
2025-05-11 09:53:59,935 - CtcTrainer - INFO - ---------------------
2025-05-11 09:53:59,937 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 09:54:01,672 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 09:54:01,672 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-11 09:54:03,266 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-11 09:54:03,266 - CtcTrainer - INFO - New best metric (val_cer) at epoch 90: 0.0559
2025-05-11 09:54:03,270 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 09:54:03,271 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 09:54:03,273 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 09:54:04,034 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 09:54:04,035 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-11 09:54:04,358 - CtcTrainer - INFO - Starting Epoch 91/100
2025-05-11 09:54:59,600 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 10:41:43,851 - CtcTrainer - INFO - Running end-of-epoch 91 validation...
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 10:41:45,780 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 10:41:45,780 - training.ctc_validation - INFO -   Prediction  : 'địng'
2025-05-11 10:41:45,781 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 10:44:40,520 - training.ctc_validation - INFO - Validation Results: Loss=5.2898, CER=0.0564, WER=0.1551
2025-05-11 10:44:40,520 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 10:44:40,522 - CtcTrainer - INFO - --- Epoch 91/100 Summary ---
2025-05-11 10:44:40,523 - CtcTrainer - INFO - Avg Train Loss: 0.0057
2025-05-11 10:44:40,523 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.289808774544279, 'val_cer': 0.056396488475260256, 'val_wer': 0.15506968826470902}
2025-05-11 10:44:40,523 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0559
2025-05-11 10:44:40,523 - CtcTrainer - INFO - ---------------------
2025-05-11 10:44:40,525 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 10:44:43,016 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 10:44:43,016 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-11 10:44:43,404 - CtcTrainer - INFO - Starting Epoch 92/100
2025-05-11 11:10:09,392 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 11:25:04,867 - CtcTrainer - INFO - Running end-of-epoch 92 validation...
2025-05-11 11:25:06,548 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 11:25:06,548 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 11:25:06,548 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 11:25:06,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 11:25:06,549 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 11:25:06,549 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 11:25:06,549 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 11:25:06,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 11:25:06,549 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 11:25:06,549 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 11:25:06,549 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 11:25:06,549 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 11:25:06,549 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 11:25:06,549 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 11:25:06,549 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 11:25:06,550 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 11:25:06,550 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 11:25:06,550 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 11:25:06,550 - training.ctc_validation - INFO -   Prediction  : 'địng'
2025-05-11 11:25:06,550 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 11:28:01,125 - training.ctc_validation - INFO - Validation Results: Loss=5.3181, CER=0.0562, WER=0.1549
2025-05-11 11:28:01,126 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 11:28:01,129 - CtcTrainer - INFO - --- Epoch 92/100 Summary ---
2025-05-11 11:28:01,129 - CtcTrainer - INFO - Avg Train Loss: 0.0054
2025-05-11 11:28:01,129 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.318132030141397, 'val_cer': 0.05621174714910544, 'val_wer': 0.15494201510799022}
2025-05-11 11:28:01,129 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0559
2025-05-11 11:28:01,129 - CtcTrainer - INFO - ---------------------
2025-05-11 11:28:01,132 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 11:28:04,037 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 11:28:04,037 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-11 11:28:04,531 - CtcTrainer - INFO - Starting Epoch 93/100
2025-05-11 11:48:32,437 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 12:08:34,983 - CtcTrainer - INFO - Running end-of-epoch 93 validation...
2025-05-11 12:08:36,805 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 12:08:36,805 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 12:08:36,805 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 12:08:36,805 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:08:36,805 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 12:08:36,805 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 12:08:36,805 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 12:08:36,805 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:08:36,805 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 12:08:36,806 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 12:08:36,806 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 12:08:36,806 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:08:36,806 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 12:08:36,806 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 12:08:36,806 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 12:08:36,806 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:08:36,806 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 12:08:36,806 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 12:08:36,806 - training.ctc_validation - INFO -   Prediction  : 'địng'
2025-05-11 12:08:36,806 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:11:32,831 - training.ctc_validation - INFO - Validation Results: Loss=5.3169, CER=0.0562, WER=0.1549
2025-05-11 12:11:32,832 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 12:11:32,835 - CtcTrainer - INFO - --- Epoch 93/100 Summary ---
2025-05-11 12:11:32,835 - CtcTrainer - INFO - Avg Train Loss: 0.0051
2025-05-11 12:11:32,835 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.316865167678897, 'val_cer': 0.05615416543705719, 'val_wer': 0.15494201510799022}
2025-05-11 12:11:32,835 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0559
2025-05-11 12:11:32,835 - CtcTrainer - INFO - ---------------------
2025-05-11 12:11:32,837 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 12:11:35,232 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 12:11:35,232 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=3, patience=10
2025-05-11 12:11:35,748 - CtcTrainer - INFO - Starting Epoch 94/100
2025-05-11 12:26:58,040 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 12:54:04,890 - CtcTrainer - INFO - Running end-of-epoch 94 validation...
2025-05-11 12:54:06,579 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 12:54:06,580 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 12:57:01,729 - training.ctc_validation - INFO - Validation Results: Loss=5.3167, CER=0.0562, WER=0.1550
2025-05-11 12:57:01,730 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 12:57:01,733 - CtcTrainer - INFO - --- Epoch 94/100 Summary ---
2025-05-11 12:57:01,733 - CtcTrainer - INFO - Avg Train Loss: 0.0047
2025-05-11 12:57:01,733 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.316742229454719, 'val_cer': 0.05615416543705719, 'val_wer': 0.15504840940525588}
2025-05-11 12:57:01,733 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0559
2025-05-11 12:57:01,733 - CtcTrainer - INFO - ---------------------
2025-05-11 12:57:01,736 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 12:57:03,693 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 12:57:03,693 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=4, patience=10
2025-05-11 12:57:04,074 - CtcTrainer - INFO - Starting Epoch 95/100
2025-05-11 13:05:36,896 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 13:37:59,512 - CtcTrainer - INFO - Running end-of-epoch 95 validation...
2025-05-11 13:38:01,619 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 13:38:01,620 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 13:40:56,966 - training.ctc_validation - INFO - Validation Results: Loss=5.3168, CER=0.0558, WER=0.1543
2025-05-11 13:40:56,967 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 13:40:56,969 - CtcTrainer - INFO - --- Epoch 95/100 Summary ---
2025-05-11 13:40:56,969 - CtcTrainer - INFO - Avg Train Loss: 0.0047
2025-05-11 13:40:56,969 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.3168110955230015, 'val_cer': 0.05575829116672545, 'val_wer': 0.15426109160548995}
2025-05-11 13:40:56,969 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0559
2025-05-11 13:40:56,969 - CtcTrainer - INFO - ---------------------
2025-05-11 13:40:56,972 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 13:40:58,683 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 13:40:58,683 - CtcTrainer - INFO - Saving best checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_best.pt...
2025-05-11 13:41:00,218 - CtcTrainer - INFO - Best checkpoint saved successfully.
2025-05-11 13:41:00,219 - CtcTrainer - INFO - New best metric (val_cer) at epoch 95: 0.0558
2025-05-11 13:41:00,222 - model.hierarchical_ctc_model - INFO - Saving HierarchicalCtcMultiScaleOcrModel model to: outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 13:41:00,223 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 13:41:00,225 - model.hierarchical_ctc_model - WARNING - Combined character vocabulary is empty during config init.
2025-05-11 13:41:01,071 - model.hierarchical_ctc_model - INFO - Model components saved to outputs/hierarchical_enhanced_diacritics/best_model_hf
2025-05-11 13:41:01,071 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=0, patience=10
2025-05-11 13:41:01,478 - CtcTrainer - INFO - Starting Epoch 96/100
2025-05-11 13:56:45,415 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 14:21:50,077 - CtcTrainer - INFO - Running end-of-epoch 96 validation...
2025-05-11 14:21:51,752 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 14:21:51,752 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 14:21:51,753 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 14:24:46,542 - training.ctc_validation - INFO - Validation Results: Loss=5.3386, CER=0.0560, WER=0.1547
2025-05-11 14:24:46,542 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 14:24:46,544 - CtcTrainer - INFO - --- Epoch 96/100 Summary ---
2025-05-11 14:24:46,544 - CtcTrainer - INFO - Avg Train Loss: 0.0046
2025-05-11 14:24:46,544 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.338556973247377, 'val_cer': 0.05596462563489835, 'val_wer': 0.15469730822427918}
2025-05-11 14:24:46,544 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0558
2025-05-11 14:24:46,545 - CtcTrainer - INFO - ---------------------
2025-05-11 14:24:46,547 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 14:24:48,432 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 14:24:48,432 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=1, patience=10
2025-05-11 14:24:48,808 - CtcTrainer - INFO - Starting Epoch 97/100
2025-05-11 14:42:14,487 - data.ctc_ocr_dataset - WARNING - Sample 158065 resulted in empty label indices for text: ''. Skipping.
2025-05-11 15:05:24,388 - CtcTrainer - INFO - Running end-of-epoch 97 validation...
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - --- Validation Sample 0 ---
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Ground Truth: 'â'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Prediction  : 'â'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - --- Validation Sample 1 ---
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Ground Truth: 'ruột'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Prediction  : 'ruật'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - --- Validation Sample 2 ---
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Ground Truth: 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Prediction  : 'hvor Gud ikke boer i Hjerter og i Huset, der er der evig'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - --- Validation Sample 3 ---
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Ground Truth: 'gian'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Prediction  : 'gian'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - --- Validation Sample 4 ---
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Ground Truth: 'đinh'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO -   Prediction  : 'định'
2025-05-11 15:05:26,279 - training.ctc_validation - INFO - ---------------------------------
2025-05-11 15:08:21,569 - training.ctc_validation - INFO - Validation Results: Loss=5.3376, CER=0.0558, WER=0.1543
2025-05-11 15:08:21,569 - training.ctc_validation - INFO - (Based on 32451 samples)
2025-05-11 15:08:21,571 - CtcTrainer - INFO - --- Epoch 97/100 Summary ---
2025-05-11 15:08:21,571 - CtcTrainer - INFO - Avg Train Loss: 0.0045
2025-05-11 15:08:21,571 - CtcTrainer - INFO - Validation Metrics: {'val_loss': 5.337590340881157, 'val_cer': 0.055830268306785766, 'val_wer': 0.1542504521757634}
2025-05-11 15:08:21,571 - CtcTrainer - INFO - Best Val Metric (val_cer) So Far: 0.0558
2025-05-11 15:08:21,572 - CtcTrainer - INFO - ---------------------
2025-05-11 15:08:21,574 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 15:08:23,617 - CtcTrainer - INFO - Latest checkpoint saved successfully.
2025-05-11 15:08:23,618 - CtcTrainer - INFO - Early Stopping Check: no_improvement_count=2, patience=10
2025-05-11 15:08:24,022 - CtcTrainer - INFO - Starting Epoch 98/100
2025-05-11 15:09:21,357 - CtcTrainer - WARNING - --- Training interrupted ---
2025-05-11 15:09:21,358 - CtcTrainer - INFO - Training loop ended. Last epoch: 97. Steps: 1771046
2025-05-11 15:09:21,358 - CtcTrainer - INFO - Attempting to save final state...
2025-05-11 15:09:21,433 - CtcTrainer - INFO - Saving latest checkpoint to outputs/hierarchical_enhanced_diacritics/checkpoints/checkpoint_latest.pt...
2025-05-11 15:09:24,136 - CtcTrainer - INFO - Latest checkpoint saved successfully.
